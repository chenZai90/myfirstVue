<template>
  <div class="basics-demo">
    <div class="page-header">
      <h1>Vue3 å“åº”å¼åŸºç¡€</h1>
      <p class="page-description">
        Vue3 æä¾›äº†å¼ºå¤§çš„å“åº”å¼ç³»ç»Ÿï¼ŒåŒ…æ‹¬ refã€reactive å’Œ toRefs ç­‰æ ¸å¿ƒAPIã€‚
        è¿™äº›å·¥å…·è®©æˆ‘ä»¬èƒ½å¤Ÿè½»æ¾åˆ›å»ºå“åº”å¼æ•°æ®ï¼Œæ„å»ºåŠ¨æ€çš„ç”¨æˆ·ç•Œé¢ã€‚
      </p>
    </div>

    <!-- refåŸºç¡€ç¤ºä¾‹ -->
    <div class="demo-section">
      <CommentBox 
        title="ref() åŸºç¡€" 
        description="refæ˜¯Vue 3å“åº”å¼ç³»ç»Ÿçš„æ ¸å¿ƒAPIä¹‹ä¸€ï¼Œç”¨äºåˆ›å»ºå“åº”å¼å¼•ç”¨ã€‚å®ƒé€šè¿‡åˆ›å»ºä¸€ä¸ªåŒ…è£…å¯¹è±¡æ¥å®ç°å“åº”å¼ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†åŸºæœ¬æ•°æ®ç±»å‹å’Œéœ€è¦é‡æ–°èµ‹å€¼çš„åœºæ™¯ã€‚refçš„è®¾è®¡è®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¿æŒå“åº”å¼ç‰¹æ€§çš„åŒæ—¶ï¼Œçµæ´»åœ°å¤„ç†å„ç§æ•°æ®ç±»å‹ã€‚"
        :concepts="[
          { name: 'å“åº”å¼å¼•ç”¨', description: 'refåˆ›å»ºä¸€ä¸ªåŒ…è£…å¯¹è±¡ï¼Œå†…éƒ¨é€šè¿‡getter/setterå®ç°å“åº”å¼è¿½è¸ª' },
          { name: 'åŸºæœ¬ç±»å‹æ”¯æŒ', description: 'ä¸“é—¨ä¸ºstringã€numberã€booleanç­‰åŸºæœ¬æ•°æ®ç±»å‹è®¾è®¡çš„å“åº”å¼è§£å†³æ–¹æ¡ˆ' },
          { name: 'é‡æ–°èµ‹å€¼èƒ½åŠ›', description: 'å¯ä»¥å®Œå…¨æ›¿æ¢refçš„å€¼ï¼ŒåŒæ—¶ä¿æŒå“åº”å¼è¿æ¥ä¸æ–­' },
          { name: 'æ¨¡æ¿è‡ªåŠ¨è§£åŒ…', description: 'Vueåœ¨æ¨¡æ¿ä¸­è‡ªåŠ¨è§£åŒ…refï¼Œæä¾›æ›´ç®€æ´çš„ä½¿ç”¨ä½“éªŒ' },
          { name: 'ç±»å‹å®‰å…¨', description: 'é…åˆTypeScriptæä¾›å®Œæ•´çš„ç±»å‹æ¨å¯¼å’Œæ£€æŸ¥' },
          { name: 'æ€§èƒ½ä¼˜åŒ–', description: 'åªæœ‰åœ¨å€¼çœŸæ­£æ”¹å˜æ—¶æ‰è§¦å‘æ›´æ–°ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“' }
        ]"
        :code-explanation="refCodeExplanation"
        :notes="[
          'åœ¨setup()å‡½æ•°å’Œå…¶ä»–JavaScriptä»£ç ä¸­ï¼Œå¿…é¡»ä½¿ç”¨.valueæ¥è®¿é—®refçš„å€¼',
          'åœ¨æ¨¡æ¿ä¸­Vueä¼šè‡ªåŠ¨è§£åŒ…refï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å˜é‡åè€Œæ— éœ€.value',
          'refç‰¹åˆ«é€‚åˆå­˜å‚¨å¯èƒ½éœ€è¦å®Œå…¨é‡æ–°èµ‹å€¼çš„æ•°æ®ï¼Œå¦‚ç”¨æˆ·è¾“å…¥ã€APIå“åº”ç­‰',
          'refçš„å“åº”å¼æ˜¯æµ…å±‚çš„ï¼Œå¦‚æœå­˜å‚¨å¯¹è±¡ï¼Œå¯¹è±¡å†…éƒ¨çš„å˜åŒ–éœ€è¦é€šè¿‡.valueè®¿é—®',
          'å¯ä»¥é€šè¿‡unref()å‡½æ•°æ¥å®‰å…¨åœ°è·å–refæˆ–æ™®é€šå€¼çš„å®é™…å†…å®¹'
        ]"
      />
      <DemoRunner>
        <RefBasicDemo />
      </DemoRunner>
      <CodeBlock :code="refBasicCode" language="javascript" />
    </div>

    <!-- reactiveåŸºç¡€ç¤ºä¾‹ -->
    <div class="demo-section">
      <CommentBox 
        title="reactive() åŸºç¡€" 
        description="reactiveæ˜¯Vue 3ä¸­ç”¨äºåˆ›å»ºæ·±åº¦å“åº”å¼å¯¹è±¡çš„æ ¸å¿ƒAPIã€‚å®ƒåŸºäºES6 Proxyå®ç°ï¼Œèƒ½å¤Ÿæ‹¦æˆªå¯¹è±¡çš„æ‰€æœ‰æ“ä½œï¼ŒåŒ…æ‹¬å±æ€§è®¿é—®ã€èµ‹å€¼ã€æšä¸¾ã€å‡½æ•°è°ƒç”¨ç­‰ã€‚reactiveç‰¹åˆ«é€‚åˆå¤„ç†å¤æ‚çš„çŠ¶æ€å¯¹è±¡ï¼Œæä¾›äº†æ¯”refæ›´è‡ªç„¶çš„å¯¹è±¡æ“ä½œä½“éªŒã€‚"
        :concepts="[
          { name: 'æ·±åº¦å“åº”å¼', description: 'reactiveä¼šé€’å½’åœ°å°†å¯¹è±¡çš„æ‰€æœ‰åµŒå¥—å±æ€§è½¬æ¢ä¸ºå“åº”å¼ï¼Œæ— è®ºåµŒå¥—å¤šæ·±' },
          { name: 'å¯¹è±¡ç±»å‹ä¸“ç”¨', description: 'ä¸“é—¨ä¸ºå¯¹è±¡ã€æ•°ç»„ã€Mapã€Setç­‰å¼•ç”¨ç±»å‹è®¾è®¡ï¼Œä¸æ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹' },
          { name: 'ç›´æ¥è®¿é—®', description: 'æ— éœ€.valueè¯­æ³•ï¼Œå¯ä»¥åƒæ“ä½œæ™®é€šå¯¹è±¡ä¸€æ ·ç›´æ¥è®¿é—®å’Œä¿®æ”¹å±æ€§' },
          { name: 'Proxyå®ç°', description: 'åŸºäºES6 Proxyå®ç°ï¼Œèƒ½å¤Ÿæ‹¦æˆªæ‰€æœ‰å±æ€§æ“ä½œï¼Œæä¾›å®Œæ•´çš„å“åº”å¼èƒ½åŠ›' },
          { name: 'ç±»å‹ä¿æŒ', description: 'ä¿æŒåŸå¯¹è±¡çš„ç±»å‹ç»“æ„ï¼Œæä¾›è‰¯å¥½çš„TypeScriptæ”¯æŒ' },
          { name: 'æ€§èƒ½ä¼˜åŒ–', description: 'åªæœ‰è¢«è®¿é—®çš„å±æ€§æ‰ä¼šè¢«è½¬æ¢ä¸ºå“åº”å¼ï¼Œå®ç°æŒ‰éœ€å“åº”å¼' }
        ]"
        :code-explanation="reactiveCodeExplanation"
        :notes="[
          'reactiveåªèƒ½ç”¨äºå¯¹è±¡ç±»å‹ï¼ˆå¯¹è±¡ã€æ•°ç»„ã€Mapã€Setï¼‰ï¼Œä¸èƒ½ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹',
          'è¿”å›çš„æ˜¯åŸå¯¹è±¡çš„å“åº”å¼ä»£ç†ï¼Œä¸æ˜¯åŸå¯¹è±¡æœ¬èº«ï¼Œä½†å¯ä»¥åƒåŸå¯¹è±¡ä¸€æ ·ä½¿ç”¨',
          'è§£æ„reactiveå¯¹è±¡ä¼šå¤±å»å“åº”å¼è¿æ¥ï¼Œéœ€è¦ä½¿ç”¨toRefs()æ¥ä¿æŒå“åº”å¼',
          'ä¸èƒ½æ›¿æ¢æ•´ä¸ªreactiveå¯¹è±¡ï¼Œåªèƒ½ä¿®æ”¹å…¶å±æ€§',
          'åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨æ—¶ï¼ŒVueä¼šè‡ªåŠ¨è¿½è¸ªå±æ€§è®¿é—®ï¼Œå®ç°ç²¾ç¡®çš„ä¾èµ–æ”¶é›†'
        ]"
      />
      <DemoRunner>
        <ReactiveBasicDemo />
      </DemoRunner>
      <CodeBlock :code="reactiveBasicCode" language="javascript" />
    </div>

    <!-- ref vs reactive å¯¹æ¯” -->
    <div class="demo-section">
      <CommentBox 
        title="ref vs reactive" 
        description="refå’Œreactiveæ˜¯Vue 3å“åº”å¼ç³»ç»Ÿçš„ä¸¤å¤§æ ¸å¿ƒAPIï¼Œå„æœ‰å…¶é€‚ç”¨åœºæ™¯å’Œç‰¹ç‚¹ã€‚ç†è§£å®ƒä»¬çš„åŒºåˆ«å’Œé€‰æ‹©åŸåˆ™ï¼Œå¯¹äºæ„å»ºé«˜æ•ˆã€å¯ç»´æŠ¤çš„Vueåº”ç”¨è‡³å…³é‡è¦ã€‚æ­£ç¡®çš„é€‰æ‹©ä¸ä»…å½±å“ä»£ç çš„å¯è¯»æ€§ï¼Œè¿˜ä¼šå½±å“åº”ç”¨çš„æ€§èƒ½å’Œå¼€å‘ä½“éªŒã€‚"
        :concepts="[
          { name: 'ä½¿ç”¨åœºæ™¯å·®å¼‚', description: 'refé€‚åˆåŸºæœ¬ç±»å‹å’Œéœ€è¦é‡æ–°èµ‹å€¼çš„å¯¹è±¡ï¼Œreactiveé€‚åˆå¤æ‚çš„çŠ¶æ€å¯¹è±¡' },
          { name: 'è®¿é—®æ–¹å¼', description: 'reféœ€è¦é€šè¿‡.valueè®¿é—®ï¼Œreactiveå¯ä»¥ç›´æ¥è®¿é—®å±æ€§' },
          { name: 'é‡æ–°èµ‹å€¼èƒ½åŠ›', description: 'refæ”¯æŒå®Œæ•´æ›¿æ¢å€¼ï¼Œreactiveåªèƒ½ä¿®æ”¹å±æ€§ï¼Œä¸èƒ½é‡æ–°èµ‹å€¼' },
          { name: 'æ€§èƒ½ç‰¹å¾', description: 'refæœ‰è½»å¾®çš„.valueè®¿é—®å¼€é”€ï¼Œreactiveå¯¹å¤§å¯¹è±¡çš„å±æ€§è®¿é—®æ›´é«˜æ•ˆ' },
          { name: 'è§£æ„è¡Œä¸º', description: 'refè§£æ„åå¤±å»å“åº”å¼ï¼Œreactiveè§£æ„ä¹Ÿå¤±å»å“åº”å¼ä½†å¯ç”¨toRefsè§£å†³' },
          { name: 'ç±»å‹æ¨å¯¼', description: 'refæä¾›æ›´å¥½çš„TypeScriptç±»å‹æ¨å¯¼ï¼Œreactiveä¿æŒåŸå¯¹è±¡ç±»å‹' }
        ]"
        :code-explanation="comparisonCodeExplanation"
        :notes="[
          'é€‰æ‹©refçš„åœºæ™¯ï¼šåŸºæœ¬æ•°æ®ç±»å‹ã€éœ€è¦é‡æ–°èµ‹å€¼çš„å¯¹è±¡ã€ç»„åˆå¼å‡½æ•°çš„è¿”å›å€¼ã€è¡¨å•è¾“å…¥ç»‘å®š',
          'é€‰æ‹©reactiveçš„åœºæ™¯ï¼šå¤æ‚çš„çŠ¶æ€å¯¹è±¡ã€ä¸éœ€è¦é‡æ–°èµ‹å€¼çš„æ•°æ®ç»“æ„ã€ç»„ä»¶çš„æœ¬åœ°çŠ¶æ€',
          'åœ¨æ¨¡æ¿ä¸­ä¸¤è€…ä½¿ç”¨æ–¹å¼åŸºæœ¬ç›¸åŒï¼ŒVueä¼šè‡ªåŠ¨å¤„ç†è§£åŒ…å’Œå“åº”å¼è¿½è¸ª',
          'å¯ä»¥æ··åˆä½¿ç”¨refå’Œreactiveï¼Œæ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„API',
          'å¯¹äºç»„åˆå¼å‡½æ•°ï¼Œé€šå¸¸è¿”å›refä»¥æä¾›æ›´å¥½çš„ä½¿ç”¨ä½“éªŒ'
        ]"
      />
      <DemoRunner>
        <ComparisonDemo />
      </DemoRunner>
      <CodeBlock :code="comparisonCode" language="javascript" />
    </div>

    <!-- toRefsç¤ºä¾‹ -->
    <div class="demo-section">
      <CommentBox 
        title="toRefs() ç”¨æ³•" 
        description="toRefsæ˜¯Vue 3æä¾›çš„é‡è¦å·¥å…·å‡½æ•°ï¼Œä¸“é—¨ç”¨äºè§£å†³reactiveå¯¹è±¡è§£æ„æ—¶å¤±å»å“åº”å¼çš„é—®é¢˜ã€‚å®ƒå°†reactiveå¯¹è±¡çš„æ¯ä¸ªå±æ€§è½¬æ¢ä¸ºç‹¬ç«‹çš„refï¼Œæ—¢ä¿æŒäº†å“åº”å¼è¿æ¥ï¼Œåˆæ”¯æŒES6è§£æ„è¯­æ³•ï¼Œæ˜¯ç»„åˆå¼å‡½æ•°è®¾è®¡ä¸­çš„å…³é”®å·¥å…·ã€‚"
        :concepts="[
          { name: 'è§£æ„æ”¯æŒ', description: 'å°†reactiveå¯¹è±¡çš„æ¯ä¸ªå±æ€§è½¬æ¢ä¸ºç‹¬ç«‹çš„refï¼Œæ”¯æŒES6è§£æ„è¯­æ³•' },
          { name: 'å“åº”å¼ä¿æŒ', description: 'è§£æ„åçš„refä¸åŸreactiveå¯¹è±¡ä¿æŒåŒå‘å“åº”å¼è¿æ¥' },
          { name: 'åŒå‘åŒæ­¥', description: 'ä¿®æ”¹è§£æ„åçš„refä¼šåŒæ­¥æ›´æ–°åŸå¯¹è±¡ï¼Œä¿®æ”¹åŸå¯¹è±¡ä¹Ÿä¼šæ›´æ–°ref' },
          { name: 'ç»„åˆå¼å‡½æ•°', description: 'æ˜¯ç»„åˆå¼å‡½æ•°è¿”å›å€¼çš„æ ‡å‡†æ¨¡å¼ï¼Œæä¾›æœ€ä½³çš„ä½¿ç”¨ä½“éªŒ' },
          { name: 'æµ…å±‚è½¬æ¢', description: 'åªè½¬æ¢å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§ï¼ŒåµŒå¥—å¯¹è±¡éœ€è¦é¢å¤–å¤„ç†' },
          { name: 'æŒ‰éœ€è½¬æ¢', description: 'å¯ä»¥é€‰æ‹©æ€§åœ°è½¬æ¢éƒ¨åˆ†å±æ€§ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå¯¹è±¡' }
        ]"
        :code-explanation="toRefsCodeExplanation"
        :notes="[
          'toRefsåªè½¬æ¢å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§ï¼ŒåµŒå¥—å¯¹è±¡çš„å±æ€§ä¸ä¼šè¢«è½¬æ¢ä¸ºref',
          'å¦‚æœåŸå±æ€§å€¼ä¸æ˜¯å“åº”å¼çš„ï¼ŒtoRefsä¼šåˆ›å»ºä¸€ä¸ªæ™®é€šçš„refåŒ…è£…è¯¥å€¼',
          'å¸¸ä¸ç»„åˆå¼å‡½æ•°é…åˆä½¿ç”¨ï¼Œè®©å‡½æ•°è¿”å›å€¼æ—¢æ”¯æŒè§£æ„åˆä¿æŒå“åº”å¼',
          'å¯¹äºä¸éœ€è¦è§£æ„çš„åœºæ™¯ï¼Œç›´æ¥ä½¿ç”¨reactiveå¯¹è±¡å¯èƒ½æ›´ç®€å•',
          'å¯ä»¥é…åˆtoRef()å‡½æ•°æ¥è½¬æ¢å•ä¸ªå±æ€§ï¼Œæä¾›æ›´ç²¾ç¡®çš„æ§åˆ¶'
        ]"
        :links="[
          { text: 'Vue3å®˜æ–¹æ–‡æ¡£ - toRefs', url: 'https://cn.vuejs.org/api/reactivity-utilities.html#torefs' }
        ]"
      />
      <DemoRunner>
        <ToRefsDemo />
      </DemoRunner>
      <CodeBlock :code="toRefsCode" language="javascript" />
    </div>
  </div>
</template>

<script>
import { defineComponent, ref, reactive, toRefs } from 'vue'
import CommentBox from '../components/CodeDemo/CommentBox.vue'
import DemoRunner from '../components/CodeDemo/DemoRunner.vue'
import CodeBlock from '../components/CodeDemo/CodeBlock.vue'

// refåŸºç¡€ç¤ºä¾‹ç»„ä»¶
const RefBasicDemo = defineComponent({
  setup() {
    const count = ref(0)
    const message = ref('Hello Vue 3!')
    const isVisible = ref(true)

    function increment() {
      count.value++
    }

    function updateMessage() {
      message.value = 'æ¶ˆæ¯å·²æ›´æ–°ï¼'
    }

    function toggleVisibility() {
      isVisible.value = !isVisible.value
    }

    return {
      count,
      message,
      isVisible,
      increment,
      updateMessage,
      toggleVisibility
    }
  },
  template: `
    <div class="demo-item">
      <h3>refåŸºç¡€ç¤ºä¾‹</h3>
      <p><strong>è®¡æ•°å™¨:</strong> {{ count }}</p>
      <p><strong>æ¶ˆæ¯:</strong> {{ message }}</p>
      <p v-if="isVisible"><strong>å¯è§æ€§:</strong> è¿™æ®µæ–‡å­—æ˜¯å¯è§çš„</p>
      <div style="margin-top: 1rem;">
        <button @click="increment">å¢åŠ è®¡æ•°</button>
        <button @click="updateMessage">æ›´æ–°æ¶ˆæ¯</button>
        <button @click="toggleVisibility">åˆ‡æ¢å¯è§æ€§</button>
      </div>
    </div>
  `
})

// reactiveåŸºç¡€ç¤ºä¾‹ç»„ä»¶
const ReactiveBasicDemo = defineComponent({
  setup() {
    const state = reactive({
      count: 0,
      user: {
        name: 'å¼ ä¸‰',
        age: 25
      },
      todos: [
        { id: 1, text: 'å­¦ä¹ Vue 3', done: false },
        { id: 2, text: 'æŒæ¡å“åº”å¼', done: true }
      ]
    })

    function increment() {
      state.count++
    }

    function updateUser() {
      state.user.name = 'æå››'
      state.user.age++
    }

    function addTodo() {
      state.todos.push({
        id: Date.now(),
        text: `æ–°ä»»åŠ¡ ${state.todos.length + 1}`,
        done: false
      })
    }

    function toggleTodo(todo) {
      todo.done = !todo.done
    }

    return {
      state,
      increment,
      updateUser,
      addTodo,
      toggleTodo
    }
  },
  template: `
    <div class="demo-item">
      <h3>reactiveåŸºç¡€ç¤ºä¾‹</h3>
      <p><strong>è®¡æ•°å™¨:</strong> {{ state.count }}</p>
      <p><strong>ç”¨æˆ·:</strong> {{ state.user.name }} ({{ state.user.age }}å²)</p>
      <div>
        <strong>å¾…åŠäº‹é¡¹:</strong>
        <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
          <li v-for="todo in state.todos" :key="todo.id" 
              :style="{ textDecoration: todo.done ? 'line-through' : 'none', cursor: 'pointer' }"
              @click="toggleTodo(todo)">
            {{ todo.text }}
          </li>
        </ul>
      </div>
      <div style="margin-top: 1rem;">
        <button @click="increment">å¢åŠ è®¡æ•°</button>
        <button @click="updateUser">æ›´æ–°ç”¨æˆ·</button>
        <button @click="addTodo">æ·»åŠ å¾…åŠ</button>
      </div>
    </div>
  `
})

// å¯¹æ¯”ç¤ºä¾‹ç»„ä»¶
const ComparisonDemo = defineComponent({
  setup() {
    const refCount = ref(0)
    const refUser = ref({ name: 'å¼ ä¸‰', age: 25 })

    const reactiveState = reactive({
      count: 0,
      user: { name: 'å¼ ä¸‰', age: 25 }
    })

    function incrementRef() {
      refCount.value++
      refUser.value.age++
    }

    function incrementReactive() {
      reactiveState.count++
      reactiveState.user.age++
    }

    function resetRef() {
      refUser.value = { name: 'æå››', age: 30 }
    }

    function resetReactive() {
      Object.assign(reactiveState.user, { name: 'æå››', age: 30 })
    }

    return {
      refCount,
      refUser,
      reactiveState,
      incrementRef,
      incrementReactive,
      resetRef,
      resetReactive
    }
  },
  template: `
    <div class="demo-item">
      <h3>ref vs reactive å¯¹æ¯”</h3>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">
        <div style="padding: 1rem; border: 1px solid #ddd; border-radius: 4px;">
          <h4>refç¤ºä¾‹</h4>
          <p>è®¡æ•°: {{ refCount }}</p>
          <p>ç”¨æˆ·: {{ refUser.name }} ({{ refUser.age }}å²)</p>
          <button @click="incrementRef">å¢åŠ </button>
          <button @click="resetRef">é‡ç½®ç”¨æˆ·</button>
        </div>
        <div style="padding: 1rem; border: 1px solid #ddd; border-radius: 4px;">
          <h4>reactiveç¤ºä¾‹</h4>
          <p>è®¡æ•°: {{ reactiveState.count }}</p>
          <p>ç”¨æˆ·: {{ reactiveState.user.name }} ({{ reactiveState.user.age }}å²)</p>
          <button @click="incrementReactive">å¢åŠ </button>
          <button @click="resetReactive">é‡ç½®ç”¨æˆ·</button>
        </div>
      </div>
    </div>
  `
})

// toRefsç¤ºä¾‹ç»„ä»¶
const ToRefsDemo = defineComponent({
  setup() {
    const state = reactive({
      count: 0,
      name: 'å¼ ä¸‰',
      email: 'zhangsan@example.com'
    })

    const { count, name, email } = toRefs(state)

    function increment() {
      count.value++
    }

    function updateName() {
      name.value = 'æå››'
    }

    function updateEmail() {
      email.value = 'lisi@example.com'
    }

    return {
      state,
      count,
      name,
      email,
      increment,
      updateName,
      updateEmail
    }
  },
  template: `
    <div class="demo-item">
      <h3>toRefsç¤ºä¾‹</h3>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">
        <div style="padding: 1rem; border: 1px solid #ddd; border-radius: 4px;">
          <h4>åŸå§‹reactiveå¯¹è±¡</h4>
          <p>è®¡æ•°: {{ state.count }}</p>
          <p>å§“å: {{ state.name }}</p>
          <p>é‚®ç®±: {{ state.email }}</p>
        </div>
        <div style="padding: 1rem; border: 1px solid #ddd; border-radius: 4px;">
          <h4>toRefsè§£æ„å</h4>
          <p>è®¡æ•°: {{ count }}</p>
          <p>å§“å: {{ name }}</p>
          <p>é‚®ç®±: {{ email }}</p>
        </div>
      </div>
      <div style="margin-top: 1rem;">
        <button @click="increment">å¢åŠ è®¡æ•°</button>
        <button @click="updateName">æ›´æ–°å§“å</button>
        <button @click="updateEmail">æ›´æ–°é‚®ç®±</button>
      </div>
      <p style="margin-top: 1rem; color: #666; font-size: 0.9rem;">
        ğŸ’¡ æç¤ºï¼šä¿®æ”¹è§£æ„åçš„refä¼šåŒæ­¥æ›´æ–°åŸå§‹å¯¹è±¡
      </p>
    </div>
  `
})

export default defineComponent({
  name: 'BasicsDemo',
  components: {
    CommentBox,
    DemoRunner,
    CodeBlock,
    RefBasicDemo,
    ReactiveBasicDemo,
    ComparisonDemo,
    ToRefsDemo
  },
  setup() {
    // code-explanation æ•°æ®
    const refCodeExplanation = [
      { code: 'const count = ref(0)', explanation: 'åˆ›å»ºä¸€ä¸ªåˆå§‹å€¼ä¸º0çš„å“åº”å¼å¼•ç”¨ï¼Œè¿”å›RefImplå¯¹è±¡' },
      { code: 'count.value++', explanation: 'åœ¨JavaScriptä¸­é€šè¿‡.valueå±æ€§è®¿é—®å’Œä¿®æ”¹å®é™…å€¼' },
      { code: '{{ count }}', explanation: 'åœ¨æ¨¡æ¿ä¸­Vueè‡ªåŠ¨è§£åŒ…ï¼Œç›´æ¥æ˜¾ç¤ºå€¼è€Œæ— éœ€.value' },
      { code: 'watch(count, (newVal) => { ... })', explanation: 'refå¯ä»¥ç›´æ¥ç”¨äºwatchã€computedç­‰å“åº”å¼API' }
    ]

    const reactiveCodeExplanation = [
      { code: 'const state = reactive({ count: 0 })', explanation: 'åˆ›å»ºä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œæ‰€æœ‰å±æ€§éƒ½è‡ªåŠ¨å˜ä¸ºå“åº”å¼' },
      { code: 'state.count++', explanation: 'ç›´æ¥è®¿é—®å’Œä¿®æ”¹å±æ€§ï¼ŒVueä¼šè‡ªåŠ¨è¿½è¸ªå˜åŒ–' },
      { code: "state.user.name = 'æå››'", explanation: 'åµŒå¥—å¯¹è±¡çš„å±æ€§ä¹Ÿæ˜¯å“åº”å¼çš„ï¼Œæ”¯æŒä»»æ„æ·±åº¦' },
      { code: 'state.items.push(newItem)', explanation: 'æ•°ç»„æ–¹æ³•ä¹Ÿä¼šè§¦å‘å“åº”å¼æ›´æ–°' }
    ]

    const comparisonCodeExplanation = [
      { code: "const refUser = ref({ name: 'å¼ ä¸‰' })", explanation: 'refåŒ…è£…å¯¹è±¡ï¼Œæ•´ä¸ªå¯¹è±¡å¯ä»¥è¢«æ›¿æ¢' },
      { code: "refUser.value = { name: 'æå››' }", explanation: 'refæ”¯æŒé‡æ–°èµ‹å€¼æ•´ä¸ªå¯¹è±¡ï¼Œä¿æŒå“åº”å¼è¿æ¥' },
      { code: "const reactiveUser = reactive({ name: 'å¼ ä¸‰' })", explanation: 'reactiveåˆ›å»ºå“åº”å¼ä»£ç†ï¼Œä¸æ”¯æŒé‡æ–°èµ‹å€¼' },
      { code: "Object.assign(reactiveUser, { name: 'æå››' })", explanation: 'reactiveéœ€è¦ä½¿ç”¨Object.assignæˆ–é€ä¸ªå±æ€§èµ‹å€¼æ¥æ›´æ–°' }
    ]

    const toRefsCodeExplanation = [
      { code: 'const { count, name } = toRefs(state)', explanation: 'å°†reactiveå¯¹è±¡çš„å±æ€§è½¬æ¢ä¸ºç‹¬ç«‹çš„refï¼Œæ”¯æŒè§£æ„' },
      { code: 'count.value++', explanation: 'ä¿®æ”¹è§£æ„åçš„refï¼ŒåŸreactiveå¯¹è±¡ä¹Ÿä¼šåŒæ­¥æ›´æ–°' },
      { code: 'state.count', explanation: 'åŸå¯¹è±¡çš„å€¼ä¹Ÿä¼šç›¸åº”æ”¹å˜ï¼Œä¿æŒåŒå‘åŒæ­¥' },
      { code: 'const { count } = toRefs(state)', explanation: 'å¯ä»¥é€‰æ‹©æ€§åœ°åªè½¬æ¢éœ€è¦çš„å±æ€§' }
    ]

    // ä»£ç ç¤ºä¾‹
    const refBasicCode = `// refåŸºç¡€ç”¨æ³• - åˆ›å»ºå“åº”å¼å¼•ç”¨
import { ref } from 'vue'

// åˆ›å»ºå“åº”å¼å¼•ç”¨
// ref() å‡½æ•°æ¥æ”¶ä¸€ä¸ªå†…éƒ¨å€¼ï¼Œè¿”å›ä¸€ä¸ªå“åº”å¼çš„ã€å¯æ›´æ”¹çš„ ref å¯¹è±¡
const count = ref(0)                    // æ•°å­—ç±»å‹çš„å“åº”å¼å¼•ç”¨
const message = ref('Hello Vue 3!')     // å­—ç¬¦ä¸²ç±»å‹çš„å“åº”å¼å¼•ç”¨
const isVisible = ref(true)             // å¸ƒå°”ç±»å‹çš„å“åº”å¼å¼•ç”¨

// åœ¨JavaScriptä¸­è®¿é—®å’Œä¿®æ”¹å€¼éœ€è¦ä½¿ç”¨.valueå±æ€§
// è¿™æ˜¯å› ä¸ºrefè¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…è£…å¯¹è±¡ï¼ŒçœŸå®å€¼å­˜å‚¨åœ¨.valueä¸­
console.log(count.value)    // è¾“å‡º: 0 - è·å–refçš„å½“å‰å€¼
count.value++               // ä¿®æ”¹refçš„å€¼ï¼Œä¼šè§¦å‘å“åº”å¼æ›´æ–°
console.log(count.value)    // è¾“å‡º: 1 - å€¼å·²ç»æ›´æ–°

// åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨æ—¶ï¼ŒVueä¼šè‡ªåŠ¨è§£åŒ…refï¼Œæ— éœ€.value
// ä¾‹å¦‚: {{ count }} è€Œä¸æ˜¯ {{ count.value }}`

    const reactiveBasicCode = `// reactiveåŸºç¡€ç”¨æ³• - åˆ›å»ºæ·±åº¦å“åº”å¼å¯¹è±¡
import { reactive } from 'vue'

// åˆ›å»ºå“åº”å¼å¯¹è±¡
// reactive() è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å“åº”å¼ä»£ç†ï¼Œæ·±åº¦è½¬æ¢æ‰€æœ‰åµŒå¥—å±æ€§
const state = reactive({
  count: 0,                                    // åŸºæœ¬å±æ€§
  user: {                                      // åµŒå¥—å¯¹è±¡
    name: 'å¼ ä¸‰',
    age: 25
  },
  todos: [                                     // æ•°ç»„ä¹Ÿæ˜¯å“åº”å¼çš„
    { id: 1, text: 'å­¦ä¹ Vue 3', done: false }
  ]
})

// ç›´æ¥è®¿é—®å’Œä¿®æ”¹å±æ€§ï¼Œæ— éœ€.value
// reactiveå¯¹è±¡çš„æ‰€æœ‰å±æ€§éƒ½æ˜¯å“åº”å¼çš„ï¼ŒåŒ…æ‹¬åµŒå¥—å±æ€§
state.count++                                  // ä¿®æ”¹åŸºæœ¬å±æ€§
state.user.name = 'æå››'                       // ä¿®æ”¹åµŒå¥—å¯¹è±¡å±æ€§
state.todos.push({                            // ä¿®æ”¹æ•°ç»„ï¼Œæ·»åŠ æ–°å…ƒç´ 
  id: 2, 
  text: 'æ–°ä»»åŠ¡', 
  done: false 
})

// æ³¨æ„ï¼šreactiveåªèƒ½ç”¨äºå¯¹è±¡ç±»å‹ï¼ˆå¯¹è±¡ã€æ•°ç»„ã€Mapã€Setç­‰ï¼‰
// ä¸èƒ½ç”¨äºåŸºæœ¬ç±»å‹ï¼ˆstringã€numberã€booleanç­‰ï¼‰`

    const comparisonCode = `// ref vs reactive å¯¹æ¯” - é€‰æ‹©åˆé€‚çš„å“åº”å¼API
import { ref, reactive } from 'vue'

// ===== refçš„ä½¿ç”¨åœºæ™¯ =====
// ref - é€‚ç”¨äºåŸºæœ¬ç±»å‹å’Œéœ€è¦é‡æ–°èµ‹å€¼çš„æƒ…å†µ
const refCount = ref(0)                        // åŸºæœ¬ç±»å‹ï¼šæ•°å­—
const refUser = ref({ name: 'å¼ ä¸‰' })          // å¯¹è±¡ç±»å‹ï¼šå¯ä»¥é‡æ–°èµ‹å€¼

// è®¿é—®å’Œä¿®æ”¹reféœ€è¦ä½¿ç”¨.value
refCount.value++                               // ä¿®æ”¹åŸºæœ¬ç±»å‹å€¼
refUser.value.name = 'æå››'                    // ä¿®æ”¹å¯¹è±¡å±æ€§

// refçš„ä¼˜åŠ¿ï¼šå¯ä»¥é‡æ–°èµ‹å€¼æ•´ä¸ªå¯¹è±¡
refUser.value = { name: 'ç‹äº”', age: 30 }      // å®Œå…¨æ›¿æ¢å¯¹è±¡ï¼Œä¿æŒå“åº”å¼

// ===== reactiveçš„ä½¿ç”¨åœºæ™¯ =====
// reactive - é€‚ç”¨äºå¤æ‚å¯¹è±¡ï¼Œä¸éœ€è¦é‡æ–°èµ‹å€¼
const reactiveState = reactive({
  count: 0,
  user: { name: 'å¼ ä¸‰' }
})

// ç›´æ¥è®¿é—®å±æ€§ï¼Œæ— éœ€.value
reactiveState.count++                          // ç›´æ¥ä¿®æ”¹å±æ€§
reactiveState.user.name = 'æå››'               // ä¿®æ”¹åµŒå¥—å±æ€§

// reactiveçš„é™åˆ¶ï¼šä¸èƒ½é‡æ–°èµ‹å€¼æ•´ä¸ªå¯¹è±¡
// reactiveState = { count: 10 }               // âŒ è¿™æ ·ä¼šå¤±å»å“åº”å¼
// æ­£ç¡®åšæ³•ï¼šä½¿ç”¨Object.assign
Object.assign(reactiveState, { count: 10, user: { name: 'èµµå…­' } })`

    const toRefsCode = `// toRefsç”¨æ³• - è§£æ„reactiveå¯¹è±¡å¹¶ä¿æŒå“åº”å¼
import { reactive, toRefs } from 'vue'

// åˆ›å»ºä¸€ä¸ªreactiveå¯¹è±¡
const state = reactive({
  count: 0,
  name: 'å¼ ä¸‰',
  email: 'zhangsan@example.com'
})

// é—®é¢˜ï¼šç›´æ¥è§£æ„ä¼šå¤±å»å“åº”å¼
// const { count, name } = state              // âŒ å¤±å»å“åº”å¼è¿æ¥

// è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨toRefsä¿æŒå“åº”å¼
// toRefså°†reactiveå¯¹è±¡çš„æ¯ä¸ªå±æ€§è½¬æ¢ä¸ºç‹¬ç«‹çš„ref
const { count, name, email } = toRefs(state)  // âœ… ä¿æŒå“åº”å¼

// ç°åœ¨å¯ä»¥åƒrefä¸€æ ·ä½¿ç”¨ï¼Œéœ€è¦.valueè®¿é—®
count.value++                                 // ä¿®æ”¹è§£æ„åçš„ref
name.value = 'æå››'                           // ä¿®æ”¹å§“å
email.value = 'lisi@example.com'             // ä¿®æ”¹é‚®ç®±

// ä¿®æ”¹ä¼šåŒå‘åŒæ­¥åˆ°åŸå¯¹è±¡
console.log(state.count)    // è¾“å‡º: 1 - åŸå¯¹è±¡ä¹Ÿæ›´æ–°äº†
console.log(state.name)     // è¾“å‡º: 'æå››' - åŒæ­¥æ›´æ–°
console.log(state.email)    // è¾“å‡º: 'lisi@example.com'

// åä¹‹ï¼Œä¿®æ”¹åŸå¯¹è±¡ä¹Ÿä¼šåŒæ­¥åˆ°è§£æ„çš„ref
state.count = 100
console.log(count.value)    // è¾“å‡º: 100 - refä¹Ÿæ›´æ–°äº†`

    return {
      refBasicCode,
      reactiveBasicCode,
      comparisonCode,
      toRefsCode,
      refCodeExplanation,
      reactiveCodeExplanation,
      comparisonCodeExplanation,
      toRefsCodeExplanation
    }
  }
})
</script>

<style scoped>
.basics-demo {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.page-header {
  text-align: center;
  margin-bottom: 3rem;
  padding: 2rem;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border-radius: 12px;
}

.page-header h1 {
  font-size: 2.5rem;
  margin-bottom: 1rem;
  font-weight: 700;
}

.page-description {
  font-size: 1.1rem;
  opacity: 0.9;
  max-width: 600px;
  margin: 0 auto;
  line-height: 1.6;
}

.demo-section {
  margin-bottom: 3rem;
}

.demo-item {
  padding: 1.5rem;
  background: #f8f9fa;
  border-radius: 8px;
  margin: 1rem 0;
}

.demo-item h3 {
  color: #2c3e50;
  margin-bottom: 1rem;
}

.demo-item p {
  margin: 0.5rem 0;
}

.demo-item button {
  padding: 0.5rem 1rem;
  margin: 0.25rem;
  border: none;
  border-radius: 4px;
  background: #3498db;
  color: white;
  cursor: pointer;
  transition: background-color 0.2s;
}

.demo-item button:hover {
  background: #2980b9;
}
</style>