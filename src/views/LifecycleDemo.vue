<template>
  <div class="lifecycle-demo">
    <h1>Vue 3 ç”Ÿå‘½å‘¨æœŸ</h1>
    <p class="intro">å­¦ä¹ Vue 3ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œäº†è§£ç»„ä»¶ä»åˆ›å»ºåˆ°é”€æ¯çš„å®Œæ•´è¿‡ç¨‹ã€‚</p>
    
    <!-- ç”Ÿå‘½å‘¨æœŸæ¦‚è§ˆ -->
    <div class="demo-section">
      <h2>ğŸ”„ ç”Ÿå‘½å‘¨æœŸæ¦‚è§ˆ</h2>
      
      <CommentBox 
        title="Vue 3 ç”Ÿå‘½å‘¨æœŸé’©å­"
        description="Vue 3çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°æ˜¯ç»„ä»¶å¼€å‘çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒä»¬å®šä¹‰äº†ç»„ä»¶ä»åˆ›å»ºåˆ°é”€æ¯çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸã€‚é€šè¿‡åˆç†ä½¿ç”¨è¿™äº›é’©å­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­£ç¡®çš„æ—¶æœºæ‰§è¡Œç›¸åº”çš„é€»è¾‘ï¼Œå®ç°é«˜æ•ˆçš„ç»„ä»¶ç®¡ç†ã€‚ç»„åˆå¼APIä½¿ç”¨onå‰ç¼€çš„å‡½æ•°æ¥æ³¨å†Œç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œæä¾›äº†æ›´çµæ´»å’Œå¯ç»„åˆçš„æ–¹å¼æ¥å¤„ç†ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚"
        :concepts="[
          { name: 'onBeforeMount', description: 'ç»„ä»¶æŒ‚è½½å‰è°ƒç”¨ï¼Œæ­¤æ—¶æ¨¡æ¿å·²ç¼–è¯‘ä½†å°šæœªæŒ‚è½½åˆ°DOM' },
          { name: 'onMounted', description: 'ç»„ä»¶æŒ‚è½½åè°ƒç”¨ï¼Œå¯ä»¥å®‰å…¨è®¿é—®DOMå’Œè¿›è¡Œåˆå§‹åŒ–æ“ä½œ' },
          { name: 'onBeforeUpdate', description: 'å“åº”å¼æ•°æ®å˜åŒ–å¯¼è‡´ç»„ä»¶é‡æ–°æ¸²æŸ“å‰è°ƒç”¨' },
          { name: 'onUpdated', description: 'ç»„ä»¶é‡æ–°æ¸²æŸ“å®Œæˆåè°ƒç”¨ï¼ŒDOMå·²æ›´æ–°' },
          { name: 'onBeforeUnmount', description: 'ç»„ä»¶å¸è½½å‰è°ƒç”¨ï¼Œé€‚åˆè¿›è¡Œæ¸…ç†å‡†å¤‡å·¥ä½œ' },
          { name: 'onUnmounted', description: 'ç»„ä»¶å¸è½½åè°ƒç”¨ï¼Œç”¨äºæ¸…ç†å‰¯ä½œç”¨å’Œé‡Šæ”¾èµ„æº' },
          { name: 'setupå‡½æ•°', description: 'ç›¸å½“äºVue 2ä¸­çš„beforeCreateå’Œcreatedçš„ç»„åˆ' },
          { name: 'é’©å­ç»„åˆ', description: 'å¯ä»¥æ³¨å†Œå¤šä¸ªç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼ŒæŒ‰æ³¨å†Œé¡ºåºæ‰§è¡Œ' }
        ]"
        :code-explanation="basicLifecycleExplanations"
        :notes="[
          'setup()å‡½æ•°åœ¨ç»„ä»¶å®ä¾‹åˆ›å»ºæ—¶ç«‹å³æ‰§è¡Œï¼Œç›¸å½“äºbeforeCreateå’Œcreated',
          'æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸé’©å­å¿…é¡»åœ¨setup()å‡½æ•°ä¸­åŒæ­¥è°ƒç”¨ï¼Œä¸èƒ½åœ¨å¼‚æ­¥å›è°ƒä¸­æ³¨å†Œ',
          'åˆç†ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å¯ä»¥æ˜¾è‘—æå‡åº”ç”¨æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ',
          'åŠ¡å¿…åœ¨onUnmountedä¸­æ¸…ç†æ‰€æœ‰å‰¯ä½œç”¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼',
          'æœåŠ¡ç«¯æ¸²æŸ“(SSR)ç¯å¢ƒä¸‹ï¼ŒæŸäº›é’©å­(å¦‚onMounted)ä¸ä¼šæ‰§è¡Œ'
        ]"
      />
      
      <DemoRunner 
        title="ç”Ÿå‘½å‘¨æœŸæ—¥å¿—ç¤ºä¾‹"
        :component="LifecycleLogDemo"
      />
      
      <CodeBlock 
        title="ç”Ÿå‘½å‘¨æœŸé’©å­ä»£ç "
        :code="lifecycleCode"
        language="vue"
      />
    </div>
    
    <!-- onMounted æŒ‚è½½å -->
    <div class="demo-section">
      <h2>ğŸš€ onMounted - ç»„ä»¶æŒ‚è½½å</h2>
      
      <CommentBox 
        title="onMounted ä½¿ç”¨åœºæ™¯"
        description="onMountedæ˜¯æœ€å¸¸ç”¨çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¹‹ä¸€ï¼Œåœ¨ç»„ä»¶æˆåŠŸæŒ‚è½½åˆ°DOMåè°ƒç”¨ã€‚æ­¤æ—¶ç»„ä»¶çš„æ¨¡æ¿å·²ç»æ¸²æŸ“å®Œæˆï¼Œæ‰€æœ‰çš„DOMå…ƒç´ éƒ½å¯ä»¥å®‰å…¨è®¿é—®ï¼Œæ˜¯è¿›è¡ŒDOMæ“ä½œã€æ•°æ®è·å–ã€ç¬¬ä¸‰æ–¹åº“åˆå§‹åŒ–çš„æœ€ä½³æ—¶æœºã€‚è¿™ä¸ªé’©å­ç¡®ä¿äº†æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªç¨³å®šçš„ç¯å¢ƒä¸­æ‰§è¡Œéœ€è¦DOMæ”¯æŒçš„æ“ä½œã€‚"
        :concepts="[
          { name: 'DOMæ“ä½œ', description: 'å®‰å…¨è®¿é—®å’Œæ“ä½œDOMå…ƒç´ ï¼Œè·å–å…ƒç´ å°ºå¯¸ã€ä½ç½®ç­‰ä¿¡æ¯' },
          { name: 'APIæ•°æ®è·å–', description: 'å‘èµ·ç½‘ç»œè¯·æ±‚è·å–åˆå§‹æ•°æ®ï¼Œå¡«å……ç»„ä»¶å†…å®¹' },
          { name: 'ç¬¬ä¸‰æ–¹åº“åˆå§‹åŒ–', description: 'åˆå§‹åŒ–å›¾è¡¨åº“ã€åœ°å›¾ç»„ä»¶ã€å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ç­‰ç¬¬ä¸‰æ–¹ç»„ä»¶' },
          { name: 'äº‹ä»¶ç›‘å¬å™¨æ³¨å†Œ', description: 'æ³¨å†Œå…¨å±€äº‹ä»¶ç›‘å¬å™¨ï¼Œå¦‚çª—å£å¤§å°å˜åŒ–ã€æ»šåŠ¨äº‹ä»¶ç­‰' },
          { name: 'å®šæ—¶å™¨å¯åŠ¨', description: 'å¯åŠ¨å®šæ—¶ä»»åŠ¡ã€è½®è¯¢æ“ä½œæˆ–åŠ¨ç”»æ•ˆæœ' },
          { name: 'ç„¦ç‚¹ç®¡ç†', description: 'è®¾ç½®åˆå§‹ç„¦ç‚¹ã€è‡ªåŠ¨èšç„¦åˆ°ç‰¹å®šè¾“å…¥æ¡†' },
          { name: 'æ€§èƒ½ç›‘æ§', description: 'å¼€å§‹æ€§èƒ½ç›‘æ§ã€ç”¨æˆ·è¡Œä¸ºè¿½è¸ªç­‰åˆ†æå·¥å…·' }
        ]"
        :code-explanation="mountedExplanations"
        :notes="[
          'åœ¨æœåŠ¡ç«¯æ¸²æŸ“(SSR)ç¯å¢ƒä¸­ï¼ŒonMountedä¸ä¼šè¢«è°ƒç”¨ï¼Œå› ä¸ºæœåŠ¡ç«¯æ²¡æœ‰DOM',
          'å½“onMountedæ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰å­ç»„ä»¶ä¹Ÿå·²ç»å®ŒæˆæŒ‚è½½ï¼Œå¯ä»¥å®‰å…¨åœ°ä¸å­ç»„ä»¶äº¤äº’',
          'è¿™æ˜¯è®¿é—®$refså’ŒDOMå…ƒç´ çš„æœ€æ—©å®‰å…¨æ—¶æœº',
          'é€‚åˆè¿›è¡Œéœ€è¦DOMå°ºå¯¸è®¡ç®—çš„åˆå§‹åŒ–å·¥ä½œ',
          'å¦‚æœéœ€è¦åœ¨æ•°æ®å˜åŒ–åæ“ä½œDOMï¼Œåº”è¯¥ä½¿ç”¨nextTickç¡®ä¿DOMæ›´æ–°å®Œæˆ'
        ]"
      />
      
      <DemoRunner 
        title="onMounted å®é™…åº”ç”¨"
        :component="MountedDemo"
      />
      
      <CodeBlock 
        title="onMounted ä»£ç ç¤ºä¾‹"
        :code="mountedCode"
        language="vue"
      />
    </div>
    
    <!-- onUpdated æ›´æ–°å -->
    <div class="demo-section">
      <h2>ğŸ”„ onUpdated - ç»„ä»¶æ›´æ–°å</h2>
      
      <CommentBox 
        title="onUpdated ä½¿ç”¨åœºæ™¯"
        description="onUpdatedåœ¨ç»„ä»¶å› å“åº”å¼æ•°æ®å˜åŒ–è€Œé‡æ–°æ¸²æŸ“å¹¶æ›´æ–°DOMåè°ƒç”¨ã€‚è¿™ä¸ªé’©å­è®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨DOMæ›´æ–°å®Œæˆåæ‰§è¡Œç›¸å…³æ“ä½œï¼Œä½†éœ€è¦è°¨æ…ä½¿ç”¨ä»¥é¿å…æ€§èƒ½é—®é¢˜ã€‚å®ƒä¸»è¦ç”¨äºéœ€è¦åŸºäºæœ€æ–°DOMçŠ¶æ€è¿›è¡Œçš„æ“ä½œï¼Œå¦‚ç¬¬ä¸‰æ–¹åº“çš„çŠ¶æ€åŒæ­¥ã€å¸ƒå±€è°ƒæ•´ç­‰ã€‚"
        :concepts="[
          { name: 'DOMæ›´æ–°åæ“ä½œ', description: 'åœ¨DOMæ›´æ–°å®Œæˆåè¿›è¡Œå…ƒç´ å°ºå¯¸æµ‹é‡ã€ä½ç½®è®¡ç®—ç­‰æ“ä½œ' },
          { name: 'ç¬¬ä¸‰æ–¹åº“çŠ¶æ€åŒæ­¥', description: 'å°†Vueç»„ä»¶çš„çŠ¶æ€å˜åŒ–åŒæ­¥åˆ°ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚å›¾è¡¨ã€åœ°å›¾ç­‰' },
          { name: 'æ»šåŠ¨ä½ç½®è°ƒæ•´', description: 'æ ¹æ®å†…å®¹å˜åŒ–è‡ªåŠ¨è°ƒæ•´æ»šåŠ¨ä½ç½®ï¼Œä¿æŒç”¨æˆ·ä½“éªŒ' },
          { name: 'å°ºå¯¸é‡æ–°è®¡ç®—', description: 'é‡æ–°è®¡ç®—å…ƒç´ å°ºå¯¸ï¼Œè°ƒæ•´å¸ƒå±€æˆ–å“åº”å¼è®¾è®¡' },
          { name: 'åŠ¨ç”»è§¦å‘', description: 'åŸºäºDOMå˜åŒ–è§¦å‘ç›¸åº”çš„åŠ¨ç”»æ•ˆæœ' },
          { name: 'æ€§èƒ½ç›‘æ§', description: 'ç›‘æ§ç»„ä»¶æ›´æ–°é¢‘ç‡å’Œæ€§èƒ½æŒ‡æ ‡' },
          { name: 'ç”¨æˆ·ä½“éªŒä¼˜åŒ–', description: 'æ ¹æ®å†…å®¹å˜åŒ–ä¼˜åŒ–ç”¨æˆ·ç•Œé¢å’Œäº¤äº’ä½“éªŒ' }
        ]"
        :code-explanation="updatedExplanations"
        :notes="[
          'ä¸¥æ ¼é¿å…åœ¨onUpdatedä¸­ç›´æ¥ä¿®æ”¹å“åº”å¼æ•°æ®ï¼Œè¿™ä¼šå¯¼è‡´æ— é™æ›´æ–°å¾ªç¯',
          'å¦‚æœå¿…é¡»ä¿®æ”¹æ•°æ®ï¼Œåº”è¯¥æ·»åŠ æ¡ä»¶åˆ¤æ–­æˆ–ä½¿ç”¨é˜²æŠ–/èŠ‚æµæœºåˆ¶',
          'å¯¹äºé¢‘ç¹æ›´æ–°çš„ç»„ä»¶ï¼ŒonUpdatedå¯èƒ½ä¼šè¢«é¢‘ç¹è°ƒç”¨ï¼Œéœ€è¦è€ƒè™‘æ€§èƒ½å½±å“',
          'ä½¿ç”¨nextTickå¯ä»¥ç¡®ä¿åœ¨DOMå®Œå…¨æ›´æ–°åå†æ‰§è¡Œæ“ä½œ',
          'å¯ä»¥é€šè¿‡æ¯”è¾ƒå‰åçŠ¶æ€æ¥é¿å…ä¸å¿…è¦çš„æ“ä½œæ‰§è¡Œ'
        ]"
      />
      
      <DemoRunner 
        title="onUpdated å®é™…åº”ç”¨"
        :component="UpdatedDemo"
      />
      
      <CodeBlock 
        title="onUpdated ä»£ç ç¤ºä¾‹"
        :code="updatedCode"
        language="vue"
      />
    </div>
    
    <!-- onUnmounted å¸è½½å -->
    <div class="demo-section">
      <h2>ğŸ§¹ onUnmounted - ç»„ä»¶å¸è½½å</h2>
      
      <CommentBox 
        title="onUnmounted æ¸…ç†å·¥ä½œ"
        description="onUnmountedæ˜¯ç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¸­æœ€é‡è¦çš„æ¸…ç†é˜¶æ®µï¼Œåœ¨ç»„ä»¶ä»DOMä¸­ç§»é™¤åè°ƒç”¨ã€‚è¿™ä¸ªé’©å­æ˜¯é˜²æ­¢å†…å­˜æ³„æ¼å’Œç¡®ä¿åº”ç”¨æ€§èƒ½çš„å…³é”®ç¯èŠ‚ã€‚æ‰€æœ‰åœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¸­åˆ›å»ºçš„å‰¯ä½œç”¨ã€ç›‘å¬å™¨ã€å®šæ—¶å™¨ç­‰éƒ½åº”è¯¥åœ¨è¿™é‡Œè¿›è¡Œæ¸…ç†ï¼Œç¡®ä¿ç»„ä»¶é”€æ¯åä¸ä¼šç•™ä¸‹ä»»ä½•ç—•è¿¹ã€‚"
        :concepts="[
          { name: 'æ¸…ç†å®šæ—¶å™¨', description: 'æ¸…é™¤æ‰€æœ‰setIntervalã€setTimeoutåˆ›å»ºçš„å®šæ—¶å™¨' },
          { name: 'ç§»é™¤äº‹ä»¶ç›‘å¬å™¨', description: 'ç§»é™¤æ‰‹åŠ¨æ·»åŠ çš„DOMäº‹ä»¶ç›‘å¬å™¨å’Œå…¨å±€äº‹ä»¶ç›‘å¬å™¨' },
          { name: 'å–æ¶ˆç½‘ç»œè¯·æ±‚', description: 'å–æ¶ˆæœªå®Œæˆçš„fetchè¯·æ±‚ã€WebSocketè¿æ¥ç­‰ç½‘ç»œæ“ä½œ' },
          { name: 'æ¸…ç†ç¬¬ä¸‰æ–¹åº“', description: 'é”€æ¯ç¬¬ä¸‰æ–¹åº“å®ä¾‹ï¼Œé‡Šæ”¾å…¶å ç”¨çš„èµ„æº' },
          { name: 'æ¸…ç†è§‚å¯Ÿå™¨', description: 'æ–­å¼€IntersectionObserverã€MutationObserverç­‰è§‚å¯Ÿå™¨' },
          { name: 'é‡Šæ”¾å†…å­˜å¼•ç”¨', description: 'æ¸…é™¤å¤§å¯¹è±¡å¼•ç”¨ï¼Œå¸®åŠ©åƒåœ¾å›æ”¶å™¨å›æ”¶å†…å­˜' },
          { name: 'æ¸…ç†ç¼“å­˜', description: 'æ¸…é™¤ç»„ä»¶ç›¸å…³çš„ç¼“å­˜æ•°æ®å’Œä¸´æ—¶æ–‡ä»¶' },
          { name: 'çŠ¶æ€é‡ç½®', description: 'é‡ç½®å…¨å±€çŠ¶æ€ä¸­ä¸è¯¥ç»„ä»¶ç›¸å…³çš„éƒ¨åˆ†' }
        ]"
        :code-explanation="unmountedExplanations"
        :notes="[
          'onUnmountedæ˜¯é˜²æ­¢å†…å­˜æ³„æ¼çš„æœ€åä¸€é“é˜²çº¿ï¼Œå¿…é¡»è®¤çœŸå¯¹å¾…',
          'æ¸…ç†å·¥ä½œåº”è¯¥ä¸åˆ›å»ºå·¥ä½œä¸€ä¸€å¯¹åº”ï¼Œç¡®ä¿æ²¡æœ‰é—æ¼',
          'ä½¿ç”¨AbortControllerå¯ä»¥ä¼˜é›…åœ°å–æ¶ˆfetchè¯·æ±‚å’Œå…¶ä»–å¼‚æ­¥æ“ä½œ',
          'å¯¹äºå¤æ‚çš„ç¬¬ä¸‰æ–¹åº“ï¼ŒæŸ¥é˜…æ–‡æ¡£äº†è§£æ­£ç¡®çš„é”€æ¯æ–¹æ³•',
          'åœ¨å¼€å‘ç¯å¢ƒä¸­å¯ä»¥æ·»åŠ æ—¥å¿—æ¥ç¡®è®¤æ¸…ç†å·¥ä½œæ˜¯å¦æ­£ç¡®æ‰§è¡Œ'
        ]"
      />
      
      <div class="demo-container">
        <DemoRunner :component="UnmountedDemo" title="onUnmounted æ¸…ç†ç¤ºä¾‹" />
      </div>
      
      <CodeBlock 
        :code="unmountedCode"
        language="javascript"
        title="onUnmounted ä»£ç ç¤ºä¾‹"
      />
    </div>
    
    <!-- ç”Ÿå‘½å‘¨æœŸå®æˆ˜ -->
    <section class="demo-section">
      <h2>âš¡ ç”Ÿå‘½å‘¨æœŸå®æˆ˜åº”ç”¨</h2>
      
      <CommentBox 
        title="å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨"
        description="ç»“åˆå¤šä¸ªç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå®ç°å®Œæ•´çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬æ•°æ®è·å–ã€æ€§èƒ½ç›‘æ§ã€èµ„æºæ¸…ç†ç­‰ã€‚"
        :concepts="[
          { name: 'æ•°æ®è·å–å’Œç¼“å­˜', description: 'åœ¨åˆé€‚çš„æ—¶æœºè·å–å’Œç¼“å­˜æ•°æ®' },
          { name: 'æ€§èƒ½ç›‘æ§', description: 'ç›‘æ§ç»„ä»¶çš„æ€§èƒ½æŒ‡æ ‡' },
          { name: 'ç”¨æˆ·è¡Œä¸ºè¿½è¸ª', description: 'è¿½è¸ªç”¨æˆ·çš„äº¤äº’è¡Œä¸º' },
          { name: 'èµ„æºç®¡ç†', description: 'åˆç†ç®¡ç†ç»„ä»¶çš„èµ„æº' }
        ]"
        :code-explanation="practicalExplanations"
        :notes="[
          'åˆç†è§„åˆ’ç”Ÿå‘½å‘¨æœŸé€»è¾‘',
          'é¿å…åœ¨é”™è¯¯çš„æ—¶æœºæ‰§è¡Œæ“ä½œ',
          'æ³¨æ„æ€§èƒ½å½±å“',
          'ç¡®ä¿èµ„æºæ­£ç¡®é‡Šæ”¾'
        ]"
      />
      
      <div class="demo-container">
        <DemoRunner :component="LifecyclePracticalDemo" title="ç”Ÿå‘½å‘¨æœŸç»¼åˆåº”ç”¨" />
      </div>
      
      <CodeBlock 
        :code="practicalCode"
        language="javascript"
        title="ç”Ÿå‘½å‘¨æœŸå®æˆ˜ä»£ç "
      />
    </section>
  </div>
</template>

<script setup>
import { defineComponent, ref, reactive, onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted, nextTick } from 'vue'
import CommentBox from '@/components/CodeDemo/CommentBox.vue'
import DemoRunner from '@/components/CodeDemo/DemoRunner.vue'
import CodeBlock from '@/components/CodeDemo/CodeBlock.vue'

// ç”Ÿå‘½å‘¨æœŸè¯´æ˜æ•°æ®
const basicLifecycleExplanations = [
  'onMounted(() => { ... }) - ç”Ÿå‘½å‘¨æœŸé’©å­åœ¨setup()ä¸­æ³¨å†Œ',
  'onMounted(() => { ... }); onMounted(() => { ... }) - å¯ä»¥æ³¨å†Œå¤šä¸ªç›¸åŒçš„é’©å­',
  'console.log(æ‰§è¡Œé¡ºåº) - é’©å­å‡½æ•°æŒ‰æ³¨å†Œé¡ºåºæ‰§è¡Œ',
  'onUnmounted(() => { cleanup() }) - ç”¨äºå¤„ç†å‰¯ä½œç”¨å’Œæ¸…ç†å·¥ä½œ'
]

const mountedExplanations = [
  'onMounted(() => { ... }) - ç»„ä»¶å·²æŒ‚è½½åˆ°DOM',
  'const el = ref.value - å¯ä»¥è®¿é—®$refså’ŒDOMå…ƒç´ ',
  'fetchData() - é€‚åˆè¿›è¡ŒAPIè°ƒç”¨',
  'initChart() - åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“'
]

const updatedExplanations = [
  'count.value++ - å“åº”å¼æ•°æ®å˜åŒ–è§¦å‘',
  'nextTick(() => { ... }) - DOMå·²ç»æ›´æ–°å®Œæˆ',
  'el.scrollHeight - å¯ä»¥è®¿é—®æ–°çš„DOMçŠ¶æ€',
  '// é¿å…: data.value = newValue - é¿å…åœ¨æ­¤ä¿®æ”¹å“åº”å¼æ•°æ®'
]

const unmountedExplanations = [
  'onUnmounted(() => { ... }) - ç»„ä»¶å³å°†è¢«é”€æ¯',
  'clearInterval(timer) - æ¸…ç†æ‰€æœ‰å‰¯ä½œç”¨',
  'removeEventListener(...) - ç§»é™¤äº‹ä»¶ç›‘å¬å™¨',
  'controller.abort() - å–æ¶ˆå¼‚æ­¥æ“ä½œ'
]

const practicalExplanations = [
  'onMounted(() => { startMonitoring() }) - å¼€å§‹æ€§èƒ½ç›‘æ§',
  'onUpdated(() => { trackUpdate() }) - è¿½è¸ªæ›´æ–°äº‹ä»¶',
  'onUnmounted(() => { cleanup() }) - æ¸…ç†æ‰€æœ‰èµ„æº'
]

// ç”Ÿå‘½å‘¨æœŸæ—¥å¿—ç¤ºä¾‹ç»„ä»¶
// ç”¨äºæ¼”ç¤ºVue 3ç”Ÿå‘½å‘¨æœŸé’©å­çš„æ‰§è¡Œé¡ºåºå’Œè§¦å‘æ—¶æœº
const LifecycleLogDemo = defineComponent({
  setup() {
    // å“åº”å¼æ•°æ®ï¼šå­˜å‚¨ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œæ—¥å¿—
    const logs = ref([])        // æ—¥å¿—åˆ—è¡¨ï¼Œè®°å½•æ¯ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­çš„æ‰§è¡Œæƒ…å†µ
    const count = ref(0)        // è®¡æ•°å™¨ï¼Œç”¨äºè§¦å‘ç»„ä»¶æ›´æ–°ä»¥è§‚å¯Ÿupdateç›¸å…³é’©å­
    const isVisible = ref(true) // æ§åˆ¶ç»„ä»¶æ˜¾ç¤º/éšè—ï¼Œç”¨äºè§‚å¯Ÿmount/unmounté’©å­
    
    // æ·»åŠ æ—¥å¿—è®°å½•çš„è¾…åŠ©å‡½æ•°
    // æ¯å½“ç”Ÿå‘½å‘¨æœŸé’©å­æ‰§è¡Œæ—¶ï¼Œè®°å½•æ‰§è¡Œæ—¶é—´å’Œæ¶ˆæ¯
    const addLog = (message) => {
      const timestamp = new Date().toLocaleTimeString() // è·å–å½“å‰æ—¶é—´æˆ³
      logs.value.push({ message, timestamp, id: Date.now() }) // æ·»åŠ åˆ°æ—¥å¿—åˆ—è¡¨
    }
    
    // ç»„ä»¶æŒ‚è½½å‰é’©å­
    // åœ¨ç»„ä»¶å®ä¾‹åˆ›å»ºå®Œæˆã€æ¨¡æ¿ç¼–è¯‘åï¼Œä½†å°šæœªæŒ‚è½½åˆ°DOMå‰è°ƒç”¨
    onBeforeMount(() => {
      addLog('ğŸ”„ onBeforeMount: ç»„ä»¶å³å°†æŒ‚è½½')
    })
    
    // ç»„ä»¶æŒ‚è½½åé’©å­
    // åœ¨ç»„ä»¶æŒ‚è½½åˆ°DOMåè°ƒç”¨ï¼Œæ­¤æ—¶å¯ä»¥è®¿é—®DOMå…ƒç´ 
    onMounted(() => {
      addLog('âœ… onMounted: ç»„ä»¶å·²æŒ‚è½½åˆ°DOM')
    })
    
    // ç»„ä»¶æ›´æ–°å‰é’©å­
    // åœ¨å“åº”å¼æ•°æ®å˜åŒ–å¯¼è‡´ç»„ä»¶é‡æ–°æ¸²æŸ“å‰è°ƒç”¨
    onBeforeUpdate(() => {
      addLog('ğŸ”„ onBeforeUpdate: ç»„ä»¶å³å°†æ›´æ–°')
    })
    
    // ç»„ä»¶æ›´æ–°åé’©å­
    // åœ¨ç»„ä»¶é‡æ–°æ¸²æŸ“å®Œæˆã€DOMæ›´æ–°åè°ƒç”¨
    onUpdated(() => {
      addLog('âœ… onUpdated: ç»„ä»¶å·²æ›´æ–°å®Œæˆ')
    })
    
    // ç»„ä»¶å¸è½½å‰é’©å­
    // åœ¨ç»„ä»¶å®ä¾‹è¢«é”€æ¯å‰è°ƒç”¨ï¼Œæ­¤æ—¶ç»„ä»¶ä»ç„¶å®Œå…¨å¯ç”¨
    onBeforeUnmount(() => {
      addLog('ğŸ”„ onBeforeUnmount: ç»„ä»¶å³å°†å¸è½½')
    })
    
    // ç»„ä»¶å¸è½½åé’©å­
    // åœ¨ç»„ä»¶å®ä¾‹è¢«é”€æ¯åè°ƒç”¨ï¼Œç”¨äºæ¸…ç†å·¥ä½œ
    onUnmounted(() => {
      console.log('âœ… onUnmounted: ç»„ä»¶å·²å¸è½½')
    })
    
    // å¢åŠ è®¡æ•°å™¨çš„æ–¹æ³•
    // ç”¨äºè§¦å‘ç»„ä»¶æ›´æ–°ï¼Œè§‚å¯ŸonBeforeUpdateå’ŒonUpdatedé’©å­çš„æ‰§è¡Œ
    const increment = () => {
      count.value++ // ä¿®æ”¹å“åº”å¼æ•°æ®ï¼Œè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“
    }
    
    // æ¸…ç©ºæ—¥å¿—çš„æ–¹æ³•
    // æ¸…é™¤æ‰€æœ‰å·²è®°å½•çš„ç”Ÿå‘½å‘¨æœŸæ—¥å¿—
    const clearLogs = () => {
      logs.value = [] // æ¸…ç©ºæ—¥å¿—æ•°ç»„
    }
    
    // åˆ‡æ¢ç»„ä»¶æ˜¾ç¤ºçŠ¶æ€çš„æ–¹æ³•
    // ç”¨äºè§‚å¯Ÿç»„ä»¶çš„æŒ‚è½½å’Œå¸è½½è¿‡ç¨‹
    const toggleComponent = () => {
      isVisible.value = !isVisible.value // åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€
    }
    
    return {
      logs,
      count,
      isVisible,
      increment,
      clearLogs,
      toggleComponent
    }
  }
})

// onMounted é’©å­ä½¿ç”¨ç¤ºä¾‹ç»„ä»¶
// æ¼”ç¤ºåœ¨ç»„ä»¶æŒ‚è½½åè¿›è¡Œæ•°æ®è·å–ã€DOMæ“ä½œå’Œäº‹ä»¶ç›‘å¬çš„æœ€ä½³å®è·µ
const MountedDemo = defineComponent({
  setup() {
    // å“åº”å¼æ•°æ®å®šä¹‰
    const userList = ref([])     // ç”¨æˆ·åˆ—è¡¨æ•°æ®ï¼Œä»APIè·å–
    const loading = ref(false)   // åŠ è½½çŠ¶æ€ï¼Œæ§åˆ¶åŠ è½½æŒ‡ç¤ºå™¨çš„æ˜¾ç¤º
    const error = ref('')        // é”™è¯¯ä¿¡æ¯ï¼Œå­˜å‚¨è¯·æ±‚å¤±è´¥æ—¶çš„é”™è¯¯æ¶ˆæ¯
    const windowSize = ref({ width: 0, height: 0 }) // çª—å£å°ºå¯¸ï¼Œç”¨äºå“åº”å¼å¸ƒå±€
    
    // å¼‚æ­¥è·å–ç”¨æˆ·æ•°æ®çš„æ–¹æ³•
    // æ¨¡æ‹Ÿä»APIè·å–ç”¨æˆ·åˆ—è¡¨ï¼Œå±•ç¤ºåœ¨onMountedä¸­è¿›è¡Œæ•°æ®è·å–çš„å…¸å‹ç”¨æ³•
    const fetchUsers = async () => {
      loading.value = true  // å¼€å§‹åŠ è½½ï¼Œæ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
      error.value = ''      // æ¸…ç©ºä¹‹å‰çš„é”™è¯¯ä¿¡æ¯
      
      try {
        // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚å»¶è¿Ÿï¼ˆå®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šæ˜¯çœŸå®çš„APIè°ƒç”¨ï¼‰
        await new Promise(resolve => setTimeout(resolve, 1000))
        
        // æ¨¡æ‹Ÿä»æœåŠ¡å™¨è·å–çš„ç”¨æˆ·æ•°æ®
        userList.value = [
          { id: 1, name: 'å¼ ä¸‰', email: 'zhangsan@example.com', avatar: 'ğŸ‘¨â€ğŸ’¼' },
          { id: 2, name: 'æå››', email: 'lisi@example.com', avatar: 'ğŸ‘©â€ğŸ’»' },
          { id: 3, name: 'ç‹äº”', email: 'wangwu@example.com', avatar: 'ğŸ‘¨â€ğŸ“' }
        ]
      } catch (err) {
        // å¤„ç†è¯·æ±‚å¤±è´¥çš„æƒ…å†µ
        error.value = 'è·å–ç”¨æˆ·æ•°æ®å¤±è´¥'
      } finally {
        // æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½è¦åœæ­¢åŠ è½½çŠ¶æ€
        loading.value = false
      }
    }
    
    // æ›´æ–°çª—å£å°ºå¯¸çš„æ–¹æ³•
    // è·å–å½“å‰çª—å£çš„å®½åº¦å’Œé«˜åº¦ï¼Œç”¨äºå“åº”å¼å¸ƒå±€è°ƒæ•´
    const updateWindowSize = () => {
      windowSize.value = {
        width: window.innerWidth,   // è·å–çª—å£å†…éƒ¨å®½åº¦
        height: window.innerHeight  // è·å–çª—å£å†…éƒ¨é«˜åº¦
      }
    }
    
    // onMountedé’©å­ï¼šç»„ä»¶æŒ‚è½½åæ‰§è¡Œçš„åˆå§‹åŒ–å·¥ä½œ
    // è¿™æ˜¯è¿›è¡Œæ•°æ®è·å–ã€DOMæ“ä½œã€äº‹ä»¶ç›‘å¬çš„æœ€ä½³æ—¶æœº
    onMounted(() => {
      fetchUsers()  // è·å–åˆå§‹ç”¨æˆ·æ•°æ®
      window.addEventListener('resize', updateWindowSize)  // æ·»åŠ çª—å£å¤§å°å˜åŒ–ç›‘å¬å™¨
      updateWindowSize()  // è·å–åˆå§‹çª—å£å°ºå¯¸
    })
    
    // onUnmountedé’©å­ï¼šç»„ä»¶å¸è½½æ—¶æ¸…ç†èµ„æº
    // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
    onUnmounted(() => {
      window.removeEventListener('resize', updateWindowSize)  // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
    })
    
    return {
      userList,
      loading,
      error,
      windowSize,
      fetchUsers
    }
  }
})

// onUpdated é’©å­ä½¿ç”¨ç¤ºä¾‹ç»„ä»¶
// æ¼”ç¤ºåœ¨ç»„ä»¶æ›´æ–°åè¿›è¡ŒDOMæ“ä½œå’ŒçŠ¶æ€åŒæ­¥çš„æœ€ä½³å®è·µ
const UpdatedDemo = defineComponent({
  setup() {
    // å“åº”å¼æ•°æ®å®šä¹‰
    const items = ref(['é¡¹ç›® 1', 'é¡¹ç›® 2', 'é¡¹ç›® 3'])  // åˆ—è¡¨æ•°æ®ï¼Œç”¨äºæ¼”ç¤ºæ›´æ–°æ“ä½œ
    const updateCount = ref(0)                      // æ›´æ–°æ¬¡æ•°è®¡æ•°å™¨
    const scrollContainer = ref(null)               // æ»šåŠ¨å®¹å™¨çš„DOMå¼•ç”¨
    
    // onUpdatedé’©å­ï¼šç»„ä»¶æ›´æ–°åæ‰§è¡Œ
    // åœ¨DOMæ›´æ–°å®Œæˆåè¿›è¡Œå¿…è¦çš„æ“ä½œï¼Œå¦‚æ»šåŠ¨ä½ç½®è°ƒæ•´
    onUpdated(() => {
      updateCount.value++  // è®°å½•ç»„ä»¶æ›´æ–°æ¬¡æ•°
      
      // ä½¿ç”¨nextTickç¡®ä¿DOMå®Œå…¨æ›´æ–°åå†æ‰§è¡Œæ“ä½œ
      nextTick(() => {
        if (scrollContainer.value) {
          // è‡ªåŠ¨æ»šåŠ¨åˆ°å®¹å™¨åº•éƒ¨ï¼Œæ˜¾ç¤ºæœ€æ–°æ·»åŠ çš„å†…å®¹
          scrollContainer.value.scrollTop = scrollContainer.value.scrollHeight
        }
      })
    })
    
    // æ·»åŠ æ–°é¡¹ç›®çš„æ–¹æ³•
    // å‘åˆ—è¡¨æœ«å°¾æ·»åŠ æ–°çš„é¡¹ç›®ï¼Œè§¦å‘ç»„ä»¶æ›´æ–°
    const addItem = () => {
      const newItem = `é¡¹ç›® ${items.value.length + 1}`
      items.value.push(newItem)  // æ·»åŠ æ–°é¡¹ç›®
    }
    
    // ç§»é™¤æŒ‡å®šç´¢å¼•é¡¹ç›®çš„æ–¹æ³•
    // ä»åˆ—è¡¨ä¸­ç§»é™¤æŒ‡å®šä½ç½®çš„é¡¹ç›®ï¼Œè§¦å‘ç»„ä»¶æ›´æ–°
    const removeItem = (index) => {
      items.value.splice(index, 1)  // ç§»é™¤æŒ‡å®šç´¢å¼•çš„é¡¹ç›®
    }
    
    return {
      items,
      updateCount,
      scrollContainer,
      addItem,
      removeItem
    }
  }
})

// onUnmounted é’©å­ä½¿ç”¨ç¤ºä¾‹ç»„ä»¶
// æ¼”ç¤ºåœ¨ç»„ä»¶å¸è½½æ—¶è¿›è¡Œèµ„æºæ¸…ç†å’Œå†…å­˜æ³„æ¼é˜²æŠ¤çš„æœ€ä½³å®è·µ
const UnmountedDemo = defineComponent({
  setup() {
    // å“åº”å¼æ•°æ®å®šä¹‰
    const timer = ref(null)      // å®šæ—¶å™¨å¼•ç”¨ï¼Œç”¨äºæ¸…ç†
    const count = ref(0)         // è®¡æ•°å™¨ï¼Œå±•ç¤ºå®šæ—¶å™¨æ•ˆæœ
    const isActive = ref(true)   // ç»„ä»¶æ´»è·ƒçŠ¶æ€abortController = ref(null)
    
    // å¯åŠ¨å®šæ—¶å™¨çš„æ–¹æ³•
    // åˆ›å»ºä¸€ä¸ªæ¯ç§’é€’å¢è®¡æ•°å™¨çš„å®šæ—¶å™¨
    const startTimer = () => {
      if (timer.value) clearInterval(timer.value)  // æ¸…ç†å·²å­˜åœ¨çš„å®šæ—¶å™¨
      timer.value = setInterval(() => {
        count.value++  // æ¯ç§’é€’å¢è®¡æ•°å™¨
      }, 1000)
    }
    
    const stopTimer = () => {
      if (timer.value) {
        clearInterval(timer.value)
        timer.value = null
      }
    }
    
    // onMountedé’©å­ï¼šç»„ä»¶æŒ‚è½½åå¯åŠ¨å®šæ—¶å™¨
    onMounted(() => {
      startTimer()  // å¯åŠ¨å®šæ—¶å™¨
    })
    
    // onUnmountedé’©å­ï¼šç»„ä»¶å¸è½½æ—¶æ¸…ç†èµ„æº
    // è¿™æ˜¯é˜²æ­¢å†…å­˜æ³„æ¼çš„å…³é”®æ­¥éª¤
    onUnmounted(() => {
      stopTimer()
      if (abortController.value) {
        abortController.value.abort()
      }
      console.log('âœ… æ‰€æœ‰èµ„æºå·²æ¸…ç†')
    })
    
    return {
      count,
      startTimer,
      stopTimer
    }
  }
})

// ç”Ÿå‘½å‘¨æœŸå®æˆ˜åº”ç”¨ç¤ºä¾‹ç»„ä»¶
// ç»¼åˆæ¼”ç¤ºæ‰€æœ‰ç”Ÿå‘½å‘¨æœŸé’©å­åœ¨çœŸå®é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯
// åŒ…æ‹¬æ€§èƒ½ç›‘æ§ã€æ•°æ®ç®¡ç†ã€èµ„æºæ¸…ç†ç­‰æœ€ä½³å®è·µ
const LifecyclePracticalDemo = defineComponent({
  setup() {
    // ä¸šåŠ¡æ•°æ®ç›¸å…³çš„å“åº”å¼çŠ¶æ€
    const userData = ref(null)    // ç”¨æˆ·æ•°æ®ï¼Œä»APIè·å–
    const loading = ref(false)    // åŠ è½½çŠ¶æ€ï¼Œæ§åˆ¶UIæ˜¾ç¤º
    const error = ref('')         // é”™è¯¯ä¿¡æ¯ï¼Œç”¨äºé”™è¯¯å¤„ç†
    
    // æ€§èƒ½ç›‘æ§ç›¸å…³çš„å“åº”å¼çŠ¶æ€
    const mountTime = ref(0)      // ç»„ä»¶æŒ‚è½½å¼€å§‹æ—¶é—´
    const updateCount = ref(0)    // ç»„ä»¶æ›´æ–°æ¬¡æ•°ç»Ÿè®¡
    const performanceData = ref({
      mountDuration: 0,    // æŒ‚è½½è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
      renderCount: 0,      // æ¸²æŸ“æ¬¡æ•°
      lastUpdateTime: 0    // æœ€åæ›´æ–°æ—¶é—´
    })
    // èµ„æºç®¡ç†ç›¸å…³çš„å“åº”å¼å¼•ç”¨
    const abortController = ref(null)  // ç”¨äºå–æ¶ˆç½‘ç»œè¯·æ±‚çš„æ§åˆ¶å™¨
    
    // æ€§èƒ½ç›‘æ§å˜é‡
    let mountStartTime = 0  // ç»„ä»¶æŒ‚è½½å¼€å§‹æ—¶é—´æˆ³
    
    // å¼‚æ­¥è·å–ç”¨æˆ·æ•°æ®çš„æ–¹æ³•
    // å±•ç¤ºå¦‚ä½•åœ¨ç»„ä»¶ä¸­è¿›è¡Œå¯å–æ¶ˆçš„ç½‘ç»œè¯·æ±‚
    const fetchUserData = async () => {
      loading.value = true  // å¼€å§‹åŠ è½½çŠ¶æ€
      
      // å¦‚æœæœ‰æ­£åœ¨è¿›è¡Œçš„è¯·æ±‚ï¼Œå…ˆå–æ¶ˆå®ƒ
      if (abortController.value) {
        abortController.value.abort()
      }
      
      // åˆ›å»ºæ–°çš„è¯·æ±‚æ§åˆ¶å™¨
      abortController.value = new AbortController()
      
      try {
        // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚å»¶è¿Ÿ
        await new Promise(resolve => setTimeout(resolve, 1000))
        
        // æ¨¡æ‹Ÿè·å–çš„ç”¨æˆ·æ•°æ®
        userData.value = {
          name: 'ç”¨æˆ·ç¤ºä¾‹',
          email: 'user@example.com',
          avatar: 'ğŸ‘¤'
        }
      } catch (error) {
        // åªå¤„ç†éå–æ¶ˆé”™è¯¯
        if (error.name !== 'AbortError') {
          console.error('è·å–æ•°æ®å¤±è´¥:', error)
        }
      } finally {
        // æ— è®ºæˆåŠŸå¤±è´¥éƒ½è¦åœæ­¢åŠ è½½çŠ¶æ€
        loading.value = false
      }
    }
    
    // onBeforeMounté’©å­ï¼šç»„ä»¶æŒ‚è½½å‰çš„å‡†å¤‡å·¥ä½œ
    // è®°å½•æŒ‚è½½å¼€å§‹æ—¶é—´ï¼Œç”¨äºæ€§èƒ½ç›‘æ§
    onBeforeMount(() => {
      mountStartTime = performance.now()  // è®°å½•æŒ‚è½½å¼€å§‹æ—¶é—´
    })
    
    // onMountedé’©å­ï¼šç»„ä»¶æŒ‚è½½åçš„åˆå§‹åŒ–å·¥ä½œ
    // è¿™æ˜¯è¿›è¡Œæ•°æ®è·å–ã€DOMæ“ä½œã€æ€§èƒ½ç»Ÿè®¡çš„æœ€ä½³æ—¶æœº
    onMounted(() => {
      const mountTime = performance.now() - mountStartTime  // è®¡ç®—æŒ‚è½½è€—æ—¶
      performanceData.value.mountDuration = Math.round(mountTime)  // ä¿å­˜æŒ‚è½½è€—æ—¶
      fetchUserData()  // è·å–åˆå§‹æ•°æ®
      console.log('ç»„ä»¶æŒ‚è½½å®Œæˆï¼Œè€—æ—¶:', mountTime, 'ms')
    })
    
    // onUpdatedé’©å­ï¼šç»„ä»¶æ›´æ–°åçš„å¤„ç†
    // ç»Ÿè®¡æ›´æ–°æ¬¡æ•°ï¼Œè®°å½•æœ€åæ›´æ–°æ—¶é—´
    onUpdated(() => {
      performanceData.value.renderCount++  // å¢åŠ æ¸²æŸ“æ¬¡æ•°
      performanceData.value.lastUpdateTime = Date.now()  // è®°å½•æœ€åæ›´æ–°æ—¶é—´
      console.log('ç»„ä»¶æ›´æ–°æ¬¡æ•°:', performanceData.value.renderCount)
    })
    
    // onUnmountedé’©å­ï¼šç»„ä»¶å¸è½½æ—¶çš„èµ„æºæ¸…ç†
    // å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
    onUnmounted(() => {
      if (abortController.value) {
        abortController.value.abort()  // å–æ¶ˆç½‘ç»œè¯·æ±‚
      }
      console.log('ç»„ä»¶å·²å¸è½½ï¼Œèµ„æºå·²æ¸…ç†')
    })
    
    return {
      userData,
      loading,
      performanceData,
      fetchUserData
    }
  }
})

// ä»£ç ç¤ºä¾‹
const lifecycleCode = `// Vue 3 ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°æ¦‚è§ˆ
// ç”Ÿå‘½å‘¨æœŸé’©å­æ˜¯ Vue ç»„ä»¶åœ¨ä¸åŒé˜¶æ®µè‡ªåŠ¨è°ƒç”¨çš„å‡½æ•°
// å®ƒä»¬è®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨ç»„ä»¶çš„ç‰¹å®šæ—¶åˆ»æ‰§è¡Œä»£ç 
import { onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted } from 'vue'

export default {
  setup() {
    // 1. onBeforeMount - ç»„ä»¶æŒ‚è½½å‰
    // è§¦å‘æ—¶æœºï¼šç»„ä»¶å®ä¾‹å·²åˆ›å»ºï¼Œä½†è¿˜æœªæŒ‚è½½åˆ° DOM
    // é€‚ç”¨åœºæ™¯ï¼šæ•°æ®åˆå§‹åŒ–ã€çŠ¶æ€è®¾ç½®
    onBeforeMount(() => {
      console.log('ç»„ä»¶å³å°†æŒ‚è½½')
      // æ­¤æ—¶å¯ä»¥è®¿é—®å“åº”å¼æ•°æ®ï¼Œä½†æ— æ³•è®¿é—® DOM å…ƒç´ 
      // é€‚åˆè¿›è¡Œæ•°æ®é¢„å¤„ç†ã€çŠ¶æ€åˆå§‹åŒ–ç­‰å·¥ä½œ
    })
    
    // 2. onMounted - ç»„ä»¶æŒ‚è½½å
    // è§¦å‘æ—¶æœºï¼šç»„ä»¶å·²æŒ‚è½½åˆ° DOMï¼Œå¯ä»¥è®¿é—® DOM å…ƒç´ 
    // é€‚ç”¨åœºæ™¯ï¼šDOM æ“ä½œã€æ•°æ®è·å–ã€ç¬¬ä¸‰æ–¹åº“åˆå§‹åŒ–
    onMounted(() => {
      console.log('ç»„ä»¶å·²æŒ‚è½½')
      // æ­¤æ—¶ç»„ä»¶çš„ DOM å·²ç»å­˜åœ¨ï¼Œå¯ä»¥ï¼š
      // - è·å– DOM å…ƒç´ å¼•ç”¨
      // - å‘èµ·ç½‘ç»œè¯·æ±‚
      // - åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚å›¾è¡¨ã€åœ°å›¾ç­‰ï¼‰
      // - æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
    })
    
    // 3. onBeforeUpdate - ç»„ä»¶æ›´æ–°å‰
    // è§¦å‘æ—¶æœºï¼šå“åº”å¼æ•°æ®å˜åŒ–ï¼ŒDOM å³å°†æ›´æ–°
    // é€‚ç”¨åœºæ™¯ï¼šè·å–æ›´æ–°å‰çš„ DOM çŠ¶æ€
    onBeforeUpdate(() => {
      console.log('ç»„ä»¶å³å°†æ›´æ–°')
      // å¯ä»¥åœ¨è¿™é‡Œè·å–æ›´æ–°å‰çš„ DOM çŠ¶æ€
      // æ³¨æ„ï¼šä¸è¦åœ¨è¿™é‡Œä¿®æ”¹å“åº”å¼æ•°æ®ï¼Œä¼šå¯¼è‡´æ— é™å¾ªç¯
    })
    
    // 4. onUpdated - ç»„ä»¶æ›´æ–°å
    // è§¦å‘æ—¶æœºï¼šDOM å·²æ ¹æ®å“åº”å¼æ•°æ®çš„å˜åŒ–å®Œæˆæ›´æ–°
    // é€‚ç”¨åœºæ™¯ï¼šDOM æ›´æ–°åçš„æ“ä½œã€ç¬¬ä¸‰æ–¹åº“çŠ¶æ€åŒæ­¥
    onUpdated(() => {
      console.log('ç»„ä»¶å·²æ›´æ–°')
      // DOM å·²æ›´æ–°å®Œæˆï¼Œå¯ä»¥ï¼š
      // - è®¿é—®æ›´æ–°åçš„ DOM å…ƒç´ 
      // - é‡æ–°è®¡ç®—å¸ƒå±€
      // - æ›´æ–°ç¬¬ä¸‰æ–¹åº“çŠ¶æ€
      // æ³¨æ„ï¼šé¿å…åœ¨è¿™é‡Œä¿®æ”¹å“åº”å¼æ•°æ®
    })
    
    // 5. onBeforeUnmount - ç»„ä»¶å¸è½½å‰
    // è§¦å‘æ—¶æœºï¼šç»„ä»¶å³å°†è¢«é”€æ¯ï¼Œä½†ä»ç„¶å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹
    // é€‚ç”¨åœºæ™¯ï¼šæ¸…ç†å·¥ä½œçš„å‡†å¤‡
    onBeforeUnmount(() => {
      console.log('ç»„ä»¶å³å°†å¸è½½')
      // ç»„ä»¶ä»ç„¶å®Œå…¨å¯ç”¨ï¼Œå¯ä»¥è¿›è¡Œæ¸…ç†å‰çš„å‡†å¤‡å·¥ä½œ
    })
    
    // 6. onUnmounted - ç»„ä»¶å¸è½½å
    // è§¦å‘æ—¶æœºï¼šç»„ä»¶å·²è¢«é”€æ¯ï¼Œä» DOM ä¸­ç§»é™¤
    // é€‚ç”¨åœºæ™¯ï¼šèµ„æºæ¸…ç†ã€å†…å­˜é‡Šæ”¾
    onUnmounted(() => {
      console.log('ç»„ä»¶å·²å¸è½½')
      // ç»„ä»¶å·²è¢«é”€æ¯ï¼Œå¿…é¡»è¿›è¡Œæ¸…ç†å·¥ä½œï¼š
      // - æ¸…é™¤å®šæ—¶å™¨
      // - å–æ¶ˆç½‘ç»œè¯·æ±‚
      // - ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
      // - é”€æ¯ç¬¬ä¸‰æ–¹åº“å®ä¾‹
      // è¿™æ˜¯é˜²æ­¢å†…å­˜æ³„æ¼çš„å…³é”®æ­¥éª¤
    })
    
    // ç”Ÿå‘½å‘¨æœŸé’©å­çš„ç‰¹ç‚¹ï¼š
    // 1. è‡ªåŠ¨è°ƒç”¨ï¼šæ— éœ€æ‰‹åŠ¨è§¦å‘ï¼ŒVue ä¼šåœ¨é€‚å½“æ—¶æœºè‡ªåŠ¨è°ƒç”¨
    // 2. æ‰§è¡Œé¡ºåºï¼šæŒ‰ç…§ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¾æ¬¡æ‰§è¡Œ
    // 3. å¼‚æ­¥æ”¯æŒï¼šé’©å­å‡½æ•°å¯ä»¥æ˜¯å¼‚æ­¥çš„
    // 4. å¤šæ¬¡æ³¨å†Œï¼šåŒä¸€ä¸ªé’©å­å¯ä»¥æ³¨å†Œå¤šæ¬¡ï¼Œä¼šæŒ‰æ³¨å†Œé¡ºåºæ‰§è¡Œ
  }
}`

const mountedCode = `// onMounted ä½¿ç”¨ç¤ºä¾‹ - æ•°æ®è·å–å’ŒDOMæ“ä½œ
// onMounted æ˜¯ç»„ä»¶æŒ‚è½½åæ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸé’©å­
// è¿™æ˜¯è¿›è¡Œ DOM æ“ä½œã€æ•°æ®è·å–ã€ç¬¬ä¸‰æ–¹åº“åˆå§‹åŒ–çš„æœ€ä½³æ—¶æœº
import { ref, onMounted } from 'vue'

export default {
  setup() {
    // å“åº”å¼æ•°æ®å®šä¹‰
    const data = ref(null)        // å­˜å‚¨è·å–çš„æ•°æ®
    const loading = ref(false)    // åŠ è½½çŠ¶æ€
    const chartInstance = ref(null) // å›¾è¡¨å®ä¾‹å¼•ç”¨
    
    // å¼‚æ­¥è·å–æ•°æ®çš„å‡½æ•°
    const fetchData = async () => {
      loading.value = true
      console.log('å¼€å§‹è·å–æ•°æ®')
      
      try {
        // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚
        const response = await fetch('/api/data')
        
        if (!response.ok) {
          throw new Error(\`HTTP error! status: \${response.status}\`)
        }
        
        data.value = await response.json()
        console.log('æ•°æ®è·å–æˆåŠŸ:', data.value)
      } catch (error) {
        console.error('è·å–æ•°æ®å¤±è´¥:', error)
        // å¯ä»¥è®¾ç½®é”™è¯¯çŠ¶æ€æˆ–æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
      } finally {
        loading.value = false
        console.log('æ•°æ®è·å–å®Œæˆ')
      }
    }
    
    // çª—å£å¤§å°æ”¹å˜çš„å¤„ç†å‡½æ•°
    const handleResize = () => {
      console.log('çª—å£å¤§å°æ”¹å˜ï¼Œå½“å‰å°ºå¯¸:', window.innerWidth, 'x', window.innerHeight)
      
      // å¦‚æœæœ‰å›¾è¡¨å®ä¾‹ï¼Œé‡æ–°è°ƒæ•´å¤§å°
      if (chartInstance.value) {
        chartInstance.value.resize()
      }
    }
    
    // åˆå§‹åŒ–å›¾è¡¨çš„å‡½æ•°
    const initChart = () => {
      // æ¨¡æ‹Ÿç¬¬ä¸‰æ–¹å›¾è¡¨åº“åˆå§‹åŒ–
      console.log('åˆå§‹åŒ–å›¾è¡¨')
      
      // å‡è®¾è¿™æ˜¯ä¸€ä¸ªå›¾è¡¨åº“çš„åˆå§‹åŒ–ä»£ç 
      // chartInstance.value = new Chart({
      //   container: '#chart-container',
      //   data: data.value,
      //   type: 'line'
      // })
      
      console.log('å›¾è¡¨åˆå§‹åŒ–å®Œæˆ')
    }
    
    // ç»„ä»¶æŒ‚è½½åæ‰§è¡Œ - è¿™æ˜¯æœ€é‡è¦çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¹‹ä¸€
    onMounted(() => {
      console.log('ç»„ä»¶å·²æŒ‚è½½åˆ° DOMï¼Œå¼€å§‹åˆå§‹åŒ–å·¥ä½œ')
      
      // 1. è·å–åˆå§‹æ•°æ®
      // è¿™æ˜¯è·å–æ•°æ®çš„æœ€ä½³æ—¶æœºï¼Œå› ä¸ºç»„ä»¶å·²ç»å­˜åœ¨äº DOM ä¸­
      fetchData()
      
      // 2. æ·»åŠ å…¨å±€äº‹ä»¶ç›‘å¬å™¨
      // ç›‘å¬çª—å£å¤§å°å˜åŒ–ï¼Œç”¨äºå“åº”å¼å¸ƒå±€è°ƒæ•´
      window.addEventListener('resize', handleResize)
      console.log('å·²æ·»åŠ çª—å£å¤§å°ç›‘å¬å™¨')
      
      // 3. åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“
      // è®¸å¤šç¬¬ä¸‰æ–¹åº“éœ€è¦åœ¨ DOM å…ƒç´ å­˜åœ¨åæ‰èƒ½åˆå§‹åŒ–
      initChart()  // åˆå§‹åŒ–å›¾è¡¨
      
      // å…¶ä»–å¯èƒ½çš„åˆå§‹åŒ–å·¥ä½œï¼š
      // - åˆå§‹åŒ–åœ°å›¾åº“ï¼šinitMap()
      // - åˆå§‹åŒ–å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼šinitEditor()
      // - åˆå§‹åŒ–æ‹–æ‹½åŠŸèƒ½ï¼šinitDragDrop()
      // - è·å– DOM å…ƒç´ å¼•ç”¨å¹¶è¿›è¡Œæ“ä½œ
      
      console.log('æ‰€æœ‰åˆå§‹åŒ–å·¥ä½œå®Œæˆ')
    })
    
    // è¿”å›æ¨¡æ¿éœ€è¦çš„æ•°æ®å’Œæ–¹æ³•
    return {
      data,           // æ•°æ®
      loading,        // åŠ è½½çŠ¶æ€
      fetchData       // æ‰‹åŠ¨åˆ·æ–°æ•°æ®çš„æ–¹æ³•
    }
    
    // onMounted çš„æœ€ä½³å®è·µï¼š
    // 1. æ•°æ®è·å–ï¼šå‘èµ· API è¯·æ±‚è·å–åˆå§‹æ•°æ®
    // 2. DOM æ“ä½œï¼šè·å– DOM å…ƒç´ å¼•ç”¨ï¼Œè®¾ç½®ç„¦ç‚¹ç­‰
    // 3. äº‹ä»¶ç›‘å¬ï¼šæ·»åŠ å…¨å±€äº‹ä»¶ç›‘å¬å™¨ï¼ˆè®°å¾—åœ¨ onUnmounted ä¸­æ¸…ç†ï¼‰
    // 4. ç¬¬ä¸‰æ–¹åº“ï¼šåˆå§‹åŒ–éœ€è¦ DOM çš„ç¬¬ä¸‰æ–¹åº“
    // 5. å®šæ—¶å™¨ï¼šå¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼ˆè®°å¾—åœ¨ onUnmounted ä¸­æ¸…ç†ï¼‰
  }
}`

const updatedCode = `// onUpdated ä½¿ç”¨ç¤ºä¾‹ - DOMæ›´æ–°åçš„æ“ä½œ
// onUpdated åœ¨ç»„ä»¶å› å“åº”å¼æ•°æ®å˜åŒ–è€Œé‡æ–°æ¸²æŸ“åè°ƒç”¨
// è¿™æ˜¯å¤„ç† DOM æ›´æ–°åæ“ä½œçš„æœ€ä½³æ—¶æœº
import { ref, onUpdated, nextTick } from 'vue'

export default {
  setup() {
    // å“åº”å¼æ•°æ®å®šä¹‰
    const list = ref(['é¡¹ç›®1', 'é¡¹ç›®2', 'é¡¹ç›®3'])  // åˆ—è¡¨æ•°æ®
    const scrollContainer = ref(null)              // æ»šåŠ¨å®¹å™¨çš„å¼•ç”¨
    const updateCount = ref(0)                     // æ›´æ–°æ¬¡æ•°ç»Ÿè®¡
    
    // ç»„ä»¶æ›´æ–°åæ‰§è¡Œ - é‡è¦çš„ç”Ÿå‘½å‘¨æœŸé’©å­
    onUpdated(() => {
      // æ¯æ¬¡ç»„ä»¶æ›´æ–°éƒ½ä¼šæ‰§è¡Œè¿™é‡Œçš„ä»£ç 
      updateCount.value++
      console.log('ç»„ä»¶å·²æ›´æ–°ï¼Œç¬¬', updateCount.value, 'æ¬¡æ›´æ–°')
      
      // ä½¿ç”¨ nextTick ç¡®ä¿ DOM å®Œå…¨æ›´æ–°å®Œæˆ
      // nextTick ä¼šåœ¨ä¸‹ä¸€ä¸ª DOM æ›´æ–°å‘¨æœŸåæ‰§è¡Œå›è°ƒ
      nextTick(() => {
        console.log('DOM æ›´æ–°å®Œæˆï¼Œå¼€å§‹åç»­æ“ä½œ')
        
        // 1. è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
        // å½“åˆ—è¡¨å†…å®¹å¢åŠ æ—¶ï¼Œè‡ªåŠ¨æ»šåŠ¨åˆ°æœ€æ–°å†…å®¹
        if (scrollContainer.value) {
          const container = scrollContainer.value
          const shouldScroll = container.scrollTop + container.clientHeight >= container.scrollHeight - 10
          
          if (shouldScroll) {
            container.scrollTop = container.scrollHeight
            console.log('å·²æ»šåŠ¨åˆ°åº•éƒ¨')
          }
        }
        
        // 2. é‡æ–°è®¡ç®—å¸ƒå±€
        // å½“å†…å®¹å˜åŒ–æ—¶ï¼Œå¯èƒ½éœ€è¦é‡æ–°è®¡ç®—å…ƒç´ å°ºå¯¸
        // recalculateLayout()
        
        // 3. æ›´æ–°ç¬¬ä¸‰æ–¹åº“çŠ¶æ€
        // åŒæ­¥ç¬¬ä¸‰æ–¹åº“çš„æ•°æ®å’ŒçŠ¶æ€
        // if (chartInstance.value) {
        //   chartInstance.value.updateData(list.value)
        //   console.log('å›¾è¡¨æ•°æ®å·²æ›´æ–°')
        // }
        
        // 4. è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
        // é€šçŸ¥çˆ¶ç»„ä»¶æˆ–å…¶ä»–ç»„ä»¶æ•°æ®å·²æ›´æ–°
        // emit('dataUpdated', list.value)
        
        // 5. æ€§èƒ½ç›‘æ§
        // å¯ä»¥åœ¨è¿™é‡Œè®°å½•æ›´æ–°æ€§èƒ½æ•°æ®
        console.log('å½“å‰åˆ—è¡¨é•¿åº¦:', list.value.length)
      })
    })
    
    // æ·»åŠ æ–°é¡¹ç›®çš„æ–¹æ³•
    const addItem = () => {
      const timestamp = Date.now()
      const newItem = \`æ–°é¡¹ç›® \${timestamp}\`
      
      list.value.push(newItem)
      console.log('æ·»åŠ æ–°é¡¹ç›®:', newItem)
      
      // è¿™ä¼šè§¦å‘å“åº”å¼æ›´æ–°ï¼Œè¿›è€Œè§¦å‘ onUpdated é’©å­
      // Vue ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° list.value çš„å˜åŒ–å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶
    }
    
    // åˆ é™¤é¡¹ç›®çš„æ–¹æ³•
    const removeItem = (index) => {
      if (index >= 0 && index < list.value.length) {
        const removedItem = list.value.splice(index, 1)[0]
        console.log('åˆ é™¤é¡¹ç›®:', removedItem)
        // è¿™ä¹Ÿä¼šè§¦å‘ç»„ä»¶æ›´æ–°
      }
    }
    
    // æ¸…ç©ºåˆ—è¡¨çš„æ–¹æ³•
    const clearList = () => {
      list.value = []
      console.log('åˆ—è¡¨å·²æ¸…ç©º')
      // è¿™ä¼šè§¦å‘å¤§å¹…åº¦çš„ DOM æ›´æ–°
    }
    
    return {
      list,              // åˆ—è¡¨æ•°æ®
      scrollContainer,   // æ»šåŠ¨å®¹å™¨å¼•ç”¨
      updateCount,       // æ›´æ–°æ¬¡æ•°
      addItem,           // æ·»åŠ é¡¹ç›®æ–¹æ³•
      removeItem,        // åˆ é™¤é¡¹ç›®æ–¹æ³•
      clearList          // æ¸…ç©ºåˆ—è¡¨æ–¹æ³•
    }
    
    // onUpdated çš„æ³¨æ„äº‹é¡¹ï¼š
    // 1. é¿å…åœ¨ onUpdated ä¸­ä¿®æ”¹å“åº”å¼æ•°æ®ï¼Œå¯èƒ½å¯¼è‡´æ— é™å¾ªç¯
    // 2. ä½¿ç”¨ nextTick ç¡®ä¿ DOM å®Œå…¨æ›´æ–°åå†æ‰§è¡Œæ“ä½œ
    // 3. è€ƒè™‘æ€§èƒ½å½±å“ï¼Œé¿å…åœ¨ onUpdated ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ
    // 4. å¯ä»¥ç”¨äºåŒæ­¥ç¬¬ä¸‰æ–¹åº“çŠ¶æ€ã€è°ƒæ•´å¸ƒå±€ã€æ»šåŠ¨ä½ç½®ç­‰
  }
}`

const unmountedCode = `// onUnmounted ä½¿ç”¨ç¤ºä¾‹ - èµ„æºæ¸…ç†
// onUnmounted æ˜¯ç»„ä»¶å¸è½½æ—¶æ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸé’©å­
// è¿™æ˜¯æ¸…ç†èµ„æºã€é˜²æ­¢å†…å­˜æ³„æ¼çš„å…³é”®æ—¶æœº
import { ref, onMounted, onUnmounted } from 'vue'

export default {
  setup() {
    // åˆ›å»ºå“åº”å¼å¼•ç”¨æ¥å­˜å‚¨éœ€è¦æ¸…ç†çš„èµ„æº
    const timer = ref(null)           // å®šæ—¶å™¨å¼•ç”¨
    const abortController = ref(null) // ç½‘ç»œè¯·æ±‚æ§åˆ¶å™¨
    const eventListeners = ref([])    // äº‹ä»¶ç›‘å¬å™¨åˆ—è¡¨
    const thirdPartyInstances = ref({}) // ç¬¬ä¸‰æ–¹åº“å®ä¾‹
    
    // å¯åŠ¨å®šæ—¶å™¨çš„å‡½æ•°
    const startTimer = () => {
      // åˆ›å»ºå®šæ—¶å™¨ï¼Œæ¯ç§’æ‰§è¡Œä¸€æ¬¡
      timer.value = setInterval(() => {
        console.log('å®šæ—¶ä»»åŠ¡æ‰§è¡Œ:', new Date().toLocaleTimeString())
        // æ¨¡æ‹Ÿå®šæ—¶ä»»åŠ¡ï¼šæ•°æ®è½®è¯¢ã€çŠ¶æ€æ›´æ–°ã€å¿ƒè·³æ£€æµ‹ç­‰
      }, 1000)
      
      console.log('å®šæ—¶å™¨å·²å¯åŠ¨ï¼ŒID:', timer.value)
    }
    
    // å¯å–æ¶ˆçš„ç½‘ç»œè¯·æ±‚å‡½æ•°
    const fetchData = async () => {
      // å–æ¶ˆä¹‹å‰çš„è¯·æ±‚ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
      if (abortController.value) {
        abortController.value.abort()
        console.log('å–æ¶ˆä¹‹å‰çš„è¯·æ±‚')
      }
      
      // åˆ›å»ºæ–°çš„ AbortController æ¥æ§åˆ¶è¯·æ±‚
      abortController.value = new AbortController()
      
      try {
        console.log('å¼€å§‹ç½‘ç»œè¯·æ±‚')
        const response = await fetch('/api/data', {
          signal: abortController.value.signal  // ä¼ å…¥ä¿¡å·ä»¥æ”¯æŒå–æ¶ˆ
        })
        
        if (!response.ok) {
          throw new Error(\`HTTP error! status: \${response.status}\`)
        }
        
        const data = await response.json()
        console.log('è¯·æ±‚æˆåŠŸ:', data)
        return data
      } catch (error) {
        // åŒºåˆ†æ­£å¸¸é”™è¯¯å’Œå–æ¶ˆé”™è¯¯
        if (error.name !== 'AbortError') {
          console.error('è¯·æ±‚å¤±è´¥:', error)
        } else {
          console.log('è¯·æ±‚å·²å–æ¶ˆ')
        }
      }
    }
    
    // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨çš„å‡½æ•°
    const addEventListeners = () => {
      // çª—å£å¤§å°æ”¹å˜ç›‘å¬å™¨
      const handleResize = () => {
        console.log('çª—å£å¤§å°æ”¹å˜')
      }
      
      // æ»šåŠ¨ç›‘å¬å™¨
      const handleScroll = () => {
        console.log('é¡µé¢æ»šåŠ¨')
      }
      
      // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
      window.addEventListener('resize', handleResize)
      document.addEventListener('scroll', handleScroll)
      
      // ä¿å­˜ç›‘å¬å™¨å¼•ç”¨ï¼Œç”¨äºåç»­æ¸…ç†
      eventListeners.value = [
        { target: window, event: 'resize', handler: handleResize },
        { target: document, event: 'scroll', handler: handleScroll }
      ]
      
      console.log('äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ')
    }
    
    // åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“çš„å‡½æ•°
    const initThirdPartyLibs = () => {
      // æ¨¡æ‹Ÿåˆå§‹åŒ–å›¾è¡¨åº“
      // thirdPartyInstances.value.chart = new Chart({
      //   container: '#chart',
      //   data: []
      // })
      
      // æ¨¡æ‹Ÿåˆå§‹åŒ–åœ°å›¾åº“
      // thirdPartyInstances.value.map = new Map({
      //   container: '#map',
      //   center: [0, 0]
      // })
      
      console.log('ç¬¬ä¸‰æ–¹åº“å·²åˆå§‹åŒ–')
    }
    
    // ç»„ä»¶æŒ‚è½½æ—¶å¯åŠ¨èµ„æº
    onMounted(() => {
      console.log('ç»„ä»¶æŒ‚è½½ï¼Œå¼€å§‹å¯åŠ¨å„ç§èµ„æº')
      
      startTimer()           // å¯åŠ¨å®šæ—¶å™¨
      fetchData()            // å‘èµ·ç½‘ç»œè¯·æ±‚
      addEventListeners()    // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
      initThirdPartyLibs()   // åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“
      
      console.log('æ‰€æœ‰èµ„æºå¯åŠ¨å®Œæˆ')
    })
    
    // ç»„ä»¶å¸è½½æ—¶æ¸…ç†æ‰€æœ‰èµ„æº - è¿™æ˜¯é˜²æ­¢å†…å­˜æ³„æ¼çš„å…³é”®
    onUnmounted(() => {
      console.log('ç»„ä»¶å³å°†å¸è½½ï¼Œå¼€å§‹æ¸…ç†èµ„æº')
      
      // 1. æ¸…ç†å®šæ—¶å™¨
      // é˜²æ­¢å†…å­˜æ³„æ¼å’Œä¸å¿…è¦çš„åå°ä»»åŠ¡
      if (timer.value) {
        clearInterval(timer.value)
        timer.value = null
        console.log('âœ… å®šæ—¶å™¨å·²æ¸…ç†')
      }
      
      // 2. å–æ¶ˆè¿›è¡Œä¸­çš„ç½‘ç»œè¯·æ±‚
      // é¿å…ç»„ä»¶å¸è½½åä»ç„¶å¤„ç†å“åº”ï¼Œé˜²æ­¢çŠ¶æ€æ›´æ–°é”™è¯¯
      if (abortController.value) {
        abortController.value.abort()
        abortController.value = null
        console.log('âœ… ç½‘ç»œè¯·æ±‚å·²å–æ¶ˆ')
      }
      
      // 3. ç§»é™¤æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨
      // é˜²æ­¢å†…å­˜æ³„æ¼å’Œæ„å¤–çš„äº‹ä»¶å¤„ç†
      eventListeners.value.forEach(({ target, event, handler }) => {
        target.removeEventListener(event, handler)
      })
      eventListeners.value = []
      console.log('âœ… äº‹ä»¶ç›‘å¬å™¨å·²æ¸…ç†')
      
      // 4. æ¸…ç†ç¬¬ä¸‰æ–¹åº“å®ä¾‹
      // é”€æ¯ç¬¬ä¸‰æ–¹åº“å®ä¾‹ï¼Œé‡Šæ”¾ç›¸å…³èµ„æº
      Object.values(thirdPartyInstances.value).forEach(instance => {
        if (instance && typeof instance.destroy === 'function') {
          instance.destroy()
        }
      })
      thirdPartyInstances.value = {}
      console.log('âœ… ç¬¬ä¸‰æ–¹åº“å®ä¾‹å·²æ¸…ç†')
      
      // 5. æ¸…ç†å…¶ä»–å¯èƒ½çš„èµ„æº
      // - WebSocket è¿æ¥
      // - IndexedDB è¿æ¥
      // - Web Workers
      // - æ–‡ä»¶è¯»å–å™¨ç­‰
      
      console.log('âœ… æ‰€æœ‰èµ„æºå·²æ¸…ç†å®Œæˆï¼Œç»„ä»¶å¯ä»¥å®‰å…¨å¸è½½')
    })
    
    return {
      // å¯ä»¥è¿”å›ä¸€äº›çŠ¶æ€ä¾›æ¨¡æ¿ä½¿ç”¨
      fetchData,  // æ‰‹åŠ¨è§¦å‘æ•°æ®è·å–
      startTimer  // æ‰‹åŠ¨å¯åŠ¨å®šæ—¶å™¨
    }
    
    // onUnmounted çš„é‡è¦æ€§ï¼š
    // 1. é˜²æ­¢å†…å­˜æ³„æ¼ï¼šæ¸…ç†å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬å™¨ç­‰
    // 2. é¿å…é”™è¯¯ï¼šå–æ¶ˆç½‘ç»œè¯·æ±‚ã€åœæ­¢å¼‚æ­¥æ“ä½œ
    // 3. èµ„æºé‡Šæ”¾ï¼šé”€æ¯ç¬¬ä¸‰æ–¹åº“å®ä¾‹ã€å…³é—­è¿æ¥
    // 4. æ€§èƒ½ä¼˜åŒ–ï¼šåœæ­¢ä¸å¿…è¦çš„åå°ä»»åŠ¡
  }
}`

const practicalCode = `// ç”Ÿå‘½å‘¨æœŸé’©å­å®æˆ˜åº”ç”¨ç¤ºä¾‹
// å±•ç¤ºå¦‚ä½•åœ¨çœŸå®é¡¹ç›®ä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­è¿›è¡Œæ•°æ®è·å–ã€æ€§èƒ½ç›‘æ§å’Œèµ„æºç®¡ç†
// è¿™æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„ç¤ºä¾‹ï¼Œæ¶µç›–äº†ç”Ÿå‘½å‘¨æœŸé’©å­çš„å…¸å‹åº”ç”¨åœºæ™¯
import { ref, onBeforeMount, onMounted, onUpdated, onUnmounted } from 'vue'

export default {
  setup() {
    // å“åº”å¼æ•°æ®å®šä¹‰
    const userData = ref(null)        // ç”¨æˆ·æ•°æ®
    const loading = ref(false)        // åŠ è½½çŠ¶æ€
    const error = ref(null)           // é”™è¯¯ä¿¡æ¯
    const performanceData = ref({     // æ€§èƒ½ç›‘æ§æ•°æ®
      mountTime: 0,                   // ç»„ä»¶æŒ‚è½½è€—æ—¶
      updateCount: 0,                 // ç»„ä»¶æ›´æ–°æ¬¡æ•°
      lastUpdateTime: 0               // æœ€åæ›´æ–°æ—¶é—´
    })
    
    // æ€§èƒ½ç›‘æ§å’Œèµ„æºç®¡ç†å˜é‡
    let mountStartTime = 0            // æŒ‚è½½å¼€å§‹æ—¶é—´
    let updateStartTime = 0           // æ›´æ–°å¼€å§‹æ—¶é—´
    const abortController = ref(null) // è¯·æ±‚æ§åˆ¶å™¨
    const timers = ref([])            // å®šæ—¶å™¨åˆ—è¡¨
    const eventListeners = ref([])    // äº‹ä»¶ç›‘å¬å™¨åˆ—è¡¨
    
    // è·å–ç”¨æˆ·æ•°æ®çš„å¼‚æ­¥å‡½æ•°
    const fetchUserData = async () => {
      loading.value = true
      error.value = null
      console.log('å¼€å§‹è·å–ç”¨æˆ·æ•°æ®')
      
      // å–æ¶ˆä¹‹å‰çš„è¯·æ±‚ï¼Œé¿å…ç«æ€æ¡ä»¶
      // è¿™æ˜¯å¤„ç†å¹¶å‘è¯·æ±‚çš„é‡è¦æŠ€å·§
      if (abortController.value) {
        abortController.value.abort()
        console.log('å–æ¶ˆä¹‹å‰çš„è¯·æ±‚ï¼Œé¿å…ç«æ€æ¡ä»¶')
      }
      
      // åˆ›å»ºæ–°çš„è¯·æ±‚æ§åˆ¶å™¨
      abortController.value = new AbortController()
      
      try {
        const response = await fetch('/api/user', {
          signal: abortController.value.signal,  // æ”¯æŒè¯·æ±‚å–æ¶ˆ
          headers: {
            'Content-Type': 'application/json',
            // å¯ä»¥æ·»åŠ è®¤è¯å¤´ç­‰
          }
        })
        
        if (!response.ok) {
          throw new Error(\`HTTP error! status: \${response.status}\`)
        }
        
        userData.value = await response.json()
        console.log('ç”¨æˆ·æ•°æ®è·å–æˆåŠŸ:', userData.value)
        
        // æ•°æ®è·å–æˆåŠŸåçš„å¤„ç†
        // å¯ä»¥è§¦å‘å…¶ä»–ç›¸å…³æ“ä½œ
        
      } catch (error) {
        // åŒºåˆ†å–æ¶ˆé”™è¯¯å’Œå…¶ä»–é”™è¯¯
        if (error.name !== 'AbortError') {
          console.error('è·å–æ•°æ®å¤±è´¥:', error)
          error.value = error.message
          // å¯ä»¥åœ¨è¿™é‡Œè®¾ç½®é”™è¯¯çŠ¶æ€æˆ–æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
          // ä¹Ÿå¯ä»¥å°è¯•é‡è¯•æœºåˆ¶
        } else {
          console.log('è¯·æ±‚è¢«å–æ¶ˆ')
        }
      } finally {
        loading.value = false
      }
    }
    
    // å¯åŠ¨å¿ƒè·³æ£€æµ‹çš„å‡½æ•°
    const startHeartbeat = () => {
      const heartbeatTimer = setInterval(() => {
        console.log('å¿ƒè·³æ£€æµ‹:', new Date().toLocaleTimeString())
        // å¯ä»¥å‘é€å¿ƒè·³è¯·æ±‚åˆ°æœåŠ¡å™¨
      }, 30000) // æ¯30ç§’ä¸€æ¬¡
      
      timers.value.push(heartbeatTimer)
      console.log('å¿ƒè·³æ£€æµ‹å·²å¯åŠ¨')
    }
    
    // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨çš„å‡½æ•°
    const setupEventListeners = () => {
      // ç½‘ç»œçŠ¶æ€ç›‘å¬
      const handleOnline = () => {
        console.log('ç½‘ç»œå·²è¿æ¥ï¼Œé‡æ–°è·å–æ•°æ®')
        fetchUserData()
      }
      
      const handleOffline = () => {
        console.log('ç½‘ç»œå·²æ–­å¼€')
        error.value = 'ç½‘ç»œè¿æ¥å·²æ–­å¼€'
      }
      
      // é¡µé¢å¯è§æ€§ç›‘å¬
      const handleVisibilityChange = () => {
        if (document.visibilityState === 'visible') {
          console.log('é¡µé¢å˜ä¸ºå¯è§ï¼Œåˆ·æ–°æ•°æ®')
          fetchUserData()
        }
      }
      
      // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
      window.addEventListener('online', handleOnline)
      window.addEventListener('offline', handleOffline)
      document.addEventListener('visibilitychange', handleVisibilityChange)
      
      // ä¿å­˜ç›‘å¬å™¨å¼•ç”¨ç”¨äºæ¸…ç†
      eventListeners.value = [
        { target: window, event: 'online', handler: handleOnline },
        { target: window, event: 'offline', handler: handleOffline },
        { target: document, event: 'visibilitychange', handler: handleVisibilityChange }
      ]
      
      console.log('äº‹ä»¶ç›‘å¬å™¨å·²è®¾ç½®')
    }
    
    // 1. onBeforeMount - ç»„ä»¶æŒ‚è½½å‰çš„æ€§èƒ½ç›‘æ§å’Œé¢„å¤„ç†
    onBeforeMount(() => {
      mountStartTime = performance.now()
      console.log('ç»„ä»¶å³å°†æŒ‚è½½ï¼Œå¼€å§‹æ€§èƒ½ç›‘æ§')
      
      // å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œä¸€äº›é¢„å¤„ç†å·¥ä½œï¼š
      // - åˆå§‹åŒ–é…ç½®
      // - è®¾ç½®é»˜è®¤çŠ¶æ€
      // - é¢„åŠ è½½å¿…è¦èµ„æº
      
      console.log('é¢„å¤„ç†å·¥ä½œå®Œæˆ')
    })
    
    // 2. onMounted - ç»„ä»¶æŒ‚è½½åçš„åˆå§‹åŒ–å·¥ä½œ
    onMounted(() => {
      // è®¡ç®—ç»„ä»¶æŒ‚è½½è€—æ—¶
      const mountTime = performance.now() - mountStartTime
      performanceData.value.mountTime = Math.round(mountTime)
      
      console.log('ç»„ä»¶æŒ‚è½½å®Œæˆï¼Œè€—æ—¶:', mountTime, 'ms')
      
      // è·å–åˆå§‹æ•°æ®
      // è¿™æ˜¯è·å–æ•°æ®çš„æœ€ä½³æ—¶æœºï¼Œå› ä¸ºç»„ä»¶å·²ç»æŒ‚è½½åˆ°DOM
      fetchUserData()
      
      // å¯åŠ¨å„ç§æœåŠ¡å’Œç›‘å¬å™¨
      startHeartbeat()        // å¯åŠ¨å¿ƒè·³æ£€æµ‹
      setupEventListeners()   // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
      
      // å…¶ä»–å¯èƒ½çš„åˆå§‹åŒ–å·¥ä½œï¼š
      // - åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“ï¼ˆå›¾è¡¨ã€åœ°å›¾ã€ç¼–è¾‘å™¨ç­‰ï¼‰
      // - è®¾ç½®ç„¦ç‚¹åˆ°ç‰¹å®šå…ƒç´ 
      // - å¯åŠ¨æ•°æ®è½®è¯¢
      // - åˆå§‹åŒ– WebSocket è¿æ¥
      
      console.log('æ‰€æœ‰åˆå§‹åŒ–å·¥ä½œå®Œæˆ')
    })
    
    // 3. onUpdated - ç»„ä»¶æ›´æ–°åçš„å¤„ç†å’Œæ€§èƒ½ç›‘æ§
    onUpdated(() => {
      // ç»Ÿè®¡ç»„ä»¶æ›´æ–°æ¬¡æ•°å’Œè€—æ—¶
      const updateTime = performance.now() - updateStartTime
      performanceData.value.updateCount++
      performanceData.value.lastUpdateTime = Math.round(updateTime)
      
      console.log('ç»„ä»¶æ›´æ–°å®Œæˆï¼Œç¬¬', performanceData.value.updateCount, 'æ¬¡æ›´æ–°ï¼Œè€—æ—¶:', updateTime, 'ms')
      
      // å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œæ›´æ–°åçš„å¤„ç†ï¼š
      // - é‡æ–°è®¡ç®—å¸ƒå±€
      // - æ›´æ–°ç¬¬ä¸‰æ–¹åº“çŠ¶æ€
      // - æ»šåŠ¨åˆ°ç‰¹å®šä½ç½®
      // - åŒæ­¥æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
      
      // æ€§èƒ½ç›‘æ§ï¼šå¦‚æœæ›´æ–°è¿‡äºé¢‘ç¹ï¼Œå¯ä»¥å‘å‡ºè­¦å‘Š
      if (performanceData.value.updateCount > 100) {
        console.warn('ç»„ä»¶æ›´æ–°æ¬¡æ•°è¿‡å¤šï¼Œå¯èƒ½å­˜åœ¨æ€§èƒ½é—®é¢˜')
      }
    })
    
    // 4. onUnmounted - ç»„ä»¶å¸è½½æ—¶çš„èµ„æºæ¸…ç†
    onUnmounted(() => {
      console.log('ç»„ä»¶å³å°†å¸è½½ï¼Œå¼€å§‹æ¸…ç†æ‰€æœ‰èµ„æº')
      
      // å–æ¶ˆè¿›è¡Œä¸­çš„ç½‘ç»œè¯·æ±‚
      if (abortController.value) {
        abortController.value.abort()
        console.log('âœ… ç½‘ç»œè¯·æ±‚å·²å–æ¶ˆ')
      }
      
      // æ¸…ç†æ‰€æœ‰å®šæ—¶å™¨
      timers.value.forEach(timer => {
        clearInterval(timer)
      })
      timers.value = []
      console.log('âœ… å®šæ—¶å™¨å·²æ¸…ç†')
      
      // ç§»é™¤æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨
      eventListeners.value.forEach(({ target, event, handler }) => {
        target.removeEventListener(event, handler)
      })
      eventListeners.value = []
      console.log('âœ… äº‹ä»¶ç›‘å¬å™¨å·²æ¸…ç†')
      
      // å…¶ä»–æ¸…ç†å·¥ä½œï¼š
      // - æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„ä¸´æ—¶æ•°æ®
      // - å…³é—­ WebSocket è¿æ¥
      // - é”€æ¯ç¬¬ä¸‰æ–¹åº“å®ä¾‹
      // - å–æ¶ˆåŠ¨ç”»å¸§è¯·æ±‚
      
      console.log('âœ… ç»„ä»¶å·²å¸è½½ï¼Œæ‰€æœ‰èµ„æºå·²æ¸…ç†å®Œæˆ')
    })
    
    // æ‰‹åŠ¨åˆ·æ–°æ•°æ®çš„æ–¹æ³•
    const refreshData = () => {
      console.log('æ‰‹åŠ¨åˆ·æ–°æ•°æ®')
      fetchUserData()
    }
    
    // é‡ç½®æ€§èƒ½æ•°æ®çš„æ–¹æ³•
    const resetPerformanceData = () => {
      performanceData.value = {
        mountTime: 0,
        updateCount: 0,
        lastUpdateTime: 0
      }
      console.log('æ€§èƒ½æ•°æ®å·²é‡ç½®')
    }
    
    // è¿”å›æ¨¡æ¿éœ€è¦çš„æ•°æ®å’Œæ–¹æ³•
    return {
      userData,              // ç”¨æˆ·æ•°æ®
      loading,               // åŠ è½½çŠ¶æ€
      error,                 // é”™è¯¯ä¿¡æ¯
      performanceData,       // æ€§èƒ½æ•°æ®
      fetchUserData,         // è·å–æ•°æ®æ–¹æ³•
      refreshData,           // åˆ·æ–°æ•°æ®æ–¹æ³•
      resetPerformanceData   // é‡ç½®æ€§èƒ½æ•°æ®æ–¹æ³•
    }
    
    // ç”Ÿå‘½å‘¨æœŸé’©å­å®æˆ˜æ€»ç»“ï¼š
    // 1. onBeforeMountï¼šæ€§èƒ½ç›‘æ§å¼€å§‹ã€é¢„å¤„ç†å·¥ä½œ
    // 2. onMountedï¼šæ•°æ®è·å–ã€èµ„æºåˆå§‹åŒ–ã€äº‹ä»¶ç›‘å¬
    // 3. onUpdatedï¼šæ€§èƒ½ç›‘æ§ã€çŠ¶æ€åŒæ­¥ã€å¸ƒå±€è°ƒæ•´
    // 4. onUnmountedï¼šèµ„æºæ¸…ç†ã€å†…å­˜é‡Šæ”¾ã€è¿æ¥å…³é—­
    // 
    // æœ€ä½³å®è·µï¼š
    // - åˆç†ä½¿ç”¨ AbortController é¿å…ç«æ€æ¡ä»¶
    // - åŠæ—¶æ¸…ç†èµ„æºé˜²æ­¢å†…å­˜æ³„æ¼
    // - è¿›è¡Œæ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–
    // - å¤„ç†ç½‘ç»œçŠ¶æ€å’Œé¡µé¢å¯è§æ€§å˜åŒ–
  }
}`
</script>

<style scoped>
.lifecycle-demo {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.page-header {
  text-align: center;
  margin-bottom: 3rem;
  padding: 2rem;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border-radius: 12px;
}

.page-header h1 {
  font-size: 2.5rem;
  margin-bottom: 1rem;
  font-weight: 700;
}

.page-description {
  font-size: 1.1rem;
  opacity: 0.9;
  max-width: 600px;
  margin: 0 auto;
  line-height: 1.6;
}

.demo-section {
  margin-bottom: 3rem;
}

.demo-container {
  margin: 2rem 0;
  padding: 1.5rem;
  background: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #e9ecef;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .lifecycle-demo {
    padding: 1rem;
  }
  
  .demo-section {
    padding: 1rem;
  }
}
</style>